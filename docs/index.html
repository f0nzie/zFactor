<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate the Compressibility Factor 'z' for Hydrocarbon Gases • zFactor</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">zFactor</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/correlation_selection.html">Selecting the Correlation</a>
    </li>
    <li>
      <a href="articles/statistics.html">Measuring errors in calculating z</a>
    </li>
    <li>
      <a href="articles/StandingKatz_chart.html">Standing-Katz chart</a>
    </li>
    <li>
      <a href="articles/Plot_StandingKatz_lp.html">Plot Stand-Katz curves</a>
    </li>
    <li>
      <a href="articles/Hall-Yarborough.html">Hall-Yarborough correlation</a>
    </li>
    <li>
      <a href="articles/Beggs-Brill.html">Beggs and Brill correlation</a>
    </li>
    <li>
      <a href="articles/Dranchuk-AbouKassem.html">Dranchuk-AbouKassem correlation</a>
    </li>
    <li>
      <a href="articles/Dranchuk-Purvis-Robinson.html">Dranchuk-Purvis-Robinson correlation</a>
    </li>
    <li>
      <a href="articles/Shell.html">Shell correlation</a>
    </li>
    <li>
      <a href="articles/Ann10.html">Artificial Neural Networks</a>
    </li>
    <li>
      <a href="articles/Papp.html">Papp correlation</a>
    </li>
    <li>
      <a href="articles/ztest.html">ztest</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/f0nzie/zFactor">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">

<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="zfactor" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#zfactor" class="anchor"></a>zFactor</h1></div>
<p>Computational tools for chemical, petrochemical and petroleum engineers. Calculates the error measures or deviation between different correlations for gas compressibility compared to the original Standing-Katz chart.</p>
<div id="motivation" class="section level2">
<h2 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h2>
<p>For the development of vertical lift performance (VLP) curves and other petroleum engineering calculations, it is necessary to calculate properties of hydrocarbons in mixtures, liquid and gaseous phases. <strong>Compressibility</strong> is one of these hydrocarbon properties. It is important to count with the apropriate correlation and know its range of applicability in order to calculate other properties dependant of <code>z</code>.</p>
<p>There are several compressibility correlations. In this package, few of them, or the most used in the industry, are being evaluated. There have been extensive studies on compressibility correlations. This evaluation is different in the sense that provides a graphical view of the range of applicability as well statistical measures of the errors, besides that the work has been written fully in <code>R</code> providing the analysis and results for peer review and reproducibility purposes. All the code, functions, notes, datasets are available via GitHub.</p>
<p>This analysis focus on sweet hydrocarbon gases. Compressibility correlations for sour gases are little bit more complicated since they show significant deviations from the curves in the Standing-Katz charts. Effects of CO2, H2S and N2 have to be accounted for. In a future release of <code>zFactor</code> correlations for <em>sour hydrocarbons gases</em> will possibly be covered.</p>
</div>
<div id="correlations-used-in-this-study" class="section level2">
<h2 class="hasAnchor">
<a href="#correlations-used-in-this-study" class="anchor"></a>Correlations used in this study</h2>
<p>The correlations that are implemented in R for the package <strong>zFactor</strong> are:</p>
<ul>
<li><p>Beggs and Brill (BB) <code>[@Azizi2010]</code></p></li>
<li><p>Hall and Yarborough (HY) <code>[@Hall1973]</code></p></li>
<li><p>Dranchuk and Abou-Kassem (DAK) <code>[@Dranchuk1975]</code></p></li>
<li><p>Dranchuk, Purvis and Robinson (DPR) <code>[@Dranchuk1973]</code></p></li>
<li><p>A correlation by Shell Oil Company (SH) <code>[@Kumar2004]</code>, <code>[@bahadori]</code>, <code>[@Almeida2014]</code>, <code>[@Al-Anazi2011]</code>, <code>[@Azizi2010]</code>, <code>[@Mohamadi-Baghmolaei2015]</code>. The Shell correlation was found cited in two books and several papers (including the equation and constants), but the original paper or authors could not be identified.</p></li>
<li><p>A correlation developed with Artificial Neural Networks (Ann10) by Kamyab et al. <code>[@Kamyab2010]</code></p></li>
<li><p>An explicit correlation by <em>I. Papp</em> <code>[@Papp1979]</code> mentioned in the comparative analysis paper by Gabor Takacs <code>[@Takacs1989]</code>. Papp’s paper is not available in English.</p></li>
</ul>
</div>
<div id="versions" class="section level2">
<h2 class="hasAnchor">
<a href="#versions" class="anchor"></a>Versions</h2>
<ul>
<li>In CRAN: <code>v 0.1.7</code>
</li>
<li>In GitHub <code>development versions</code>
</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>I recommend installing from GitHub using <code>devtools</code>, that way you get the latest and greatest version. CRAN release cycles allows updates every one to two months.</p>
<p>You can install the latest version of <code>zFactor</code> from GitHub with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"f0nzie/zFactor"</span>)</code></pre></div>
<p>Or, if your prefer, from <code>CRAN</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"zFactor"</span>)</code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

<span class="co"># get `z` values from the Standing-Katz chart</span>
tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.2</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>) 
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>) 
<span class="kw"><a href="reference/getStandingKatzMatrix.html">getStandingKatzMatrix</a></span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr, 
                                 <span class="dt">pprRange =</span> <span class="st">"lp"</span>)
<span class="co">#&gt;        0.5   1.5   2.5   3.5   4.5   5.5</span>
<span class="co">#&gt; 1.20 0.893 0.657 0.519 0.565 0.650 0.741</span>
<span class="co">#&gt; 1.30 0.916 0.756 0.638 0.633 0.684 0.759</span>
<span class="co">#&gt; 1.50 0.948 0.859 0.794 0.770 0.790 0.836</span>
<span class="co">#&gt; 2.00 0.982 0.956 0.941 0.937 0.945 0.969</span>
<span class="co">#&gt; 3.00 1.002 1.009 1.018 1.029 1.041 1.056</span>

<span class="co"># calculate `z` using the Beggs-Brill correlation</span>
<span class="kw"><a href="reference/Beggs-Brill.html">z.BeggsBrill</a></span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">2.0</span>)
<span class="co">#&gt; [1] 0.962902</span>

<span class="co"># calculate `z` using the Hall-Yarborough correlation</span>
<span class="kw"><a href="reference/Hall-Yarborough.html">z.HallYarborough</a></span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">2.0</span>)
<span class="co">#&gt; [1] 0.9580002</span>

<span class="co"># calculate `z` using the correlation Dranchuk-AbousKassem</span>
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 
tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.7</span>, <span class="dv">2</span>) 
<span class="kw"><a href="reference/Dranchuk-AbouKassem.html">z.DranchukAbuKassem</a></span>(ppr, tpr)
<span class="co">#&gt;            0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co">#&gt; 1.05 0.8300683 0.2837318 0.3868282 0.5063005 0.6239783 0.7392097 0.8521762</span>
<span class="co">#&gt; 1.1  0.8570452 0.4463987 0.4125200 0.5178068 0.6281858 0.7378206 0.8458725</span>
<span class="co">#&gt; 1.7  0.9681353 0.9128087 0.8753784 0.8619509 0.8721085 0.9003962 0.9409634</span>
<span class="co">#&gt; 2    0.9824731 0.9551087 0.9400752 0.9385273 0.9497137 0.9715388 1.0015560</span>

<span class="co"># We do the same with the Dranchuk-Purvis-Robinson correlation</span>
<span class="co"># but we change the values of the isotherms `Tpr`</span>
tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.4</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span>, <span class="fl">1.7</span>, <span class="fl">1.8</span>) 
<span class="kw"><a href="reference/Dranchuk-Purvis-Robinson.html">z.DranchukPurvisRobinson</a></span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)
<span class="co">#&gt;           0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co">#&gt; 1.4 0.9374909 0.8155126 0.7275722 0.7083606 0.7404910 0.7977524 0.8666456</span>
<span class="co">#&gt; 1.4 0.9374909 0.8155126 0.7275722 0.7083606 0.7404910 0.7977524 0.8666456</span>
<span class="co">#&gt; 1.6 0.9602585 0.8891708 0.8399510 0.8230070 0.8364902 0.8709715 0.9183151</span>
<span class="co">#&gt; 1.7 0.9677844 0.9121791 0.8752677 0.8630002 0.8743271 0.9033216 0.9440582</span>
<span class="co">#&gt; 1.8 0.9736897 0.9298230 0.9022519 0.8944207 0.9053965 0.9311395 0.9672850</span>

<span class="co"># now we use the relative undocumented Shell correlation</span>
<span class="kw"><a href="reference/Shell.html">z.Shell</a></span>(ppr, tpr)
<span class="co">#&gt;           0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co">#&gt; 1.4 0.9357838 0.8097802 0.7271788 0.7040931 0.7315325 0.7907497 0.8641572</span>
<span class="co">#&gt; 1.4 0.9357838 0.8097802 0.7271788 0.7040931 0.7315325 0.7907497 0.8641572</span>
<span class="co">#&gt; 1.6 0.9613216 0.8863715 0.8331061 0.8120822 0.8224613 0.8570695 0.9073678</span>
<span class="co">#&gt; 1.7 0.9711067 0.9150837 0.8740757 0.8563697 0.8629757 0.8901157 0.9321262</span>
<span class="co">#&gt; 1.8 0.9794808 0.9395295 0.9097288 0.8964473 0.9015059 0.9233190 0.9584750</span>

<span class="co"># the newly added Papp correlation</span>
<span class="kw"><a href="reference/Papp.html">z.Papp</a></span>(ppr, tpr)
<span class="co">#&gt;           0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co">#&gt; 1.4 0.9408336 0.8010648 0.7076525 0.6906870 0.7299354 0.7958370 0.8705316</span>
<span class="co">#&gt; 1.4 0.9408336 0.8010648 0.7076525 0.6906870 0.7299354 0.7958370 0.8705316</span>
<span class="co">#&gt; 1.6 0.9657774 0.8864710 0.8252564 0.8026787 0.8182983 0.8604984 0.9168234</span>
<span class="co">#&gt; 1.7 0.9736623 0.9138939 0.8665932 0.8471834 0.8578133 0.8919610 0.9406180</span>
<span class="co">#&gt; 1.8 0.9796287 0.9345928 0.8988524 0.8837788 0.8922563 0.9208289 0.9632719</span>

<span class="co"># and finally the correlation Kamyab et al that uses Artificial Neural Networks</span>
<span class="kw"><a href="reference/Ann10.html">z.Ann10</a></span>(ppr, tpr)
<span class="co">#&gt;           0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co">#&gt; 1.4 0.9367118 0.8179531 0.7301083 0.7058966 0.7360320 0.7938440 0.8650626</span>
<span class="co">#&gt; 1.4 0.9367118 0.8179531 0.7301083 0.7058966 0.7360320 0.7938440 0.8650626</span>
<span class="co">#&gt; 1.6 0.9607316 0.8909372 0.8413772 0.8186001 0.8303206 0.8669610 0.9174184</span>
<span class="co">#&gt; 1.7 0.9682749 0.9146453 0.8767457 0.8581919 0.8672123 0.8978116 0.9413442</span>
<span class="co">#&gt; 1.8 0.9758251 0.9330673 0.9033038 0.8900081 0.8983954 0.9253309 0.9638663</span></code></pre></div>
</div>
<div id="range-of-applicability" class="section level2">
<h2 class="hasAnchor">
<a href="#range-of-applicability" class="anchor"></a>Range of Applicability</h2>
<p>How to interpret the colors? We use the <a href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error">Mean Absolute Percentage Error</a> or <code>MAPE</code> to visualize how close the correlation follow the experimental values of the Standing-Katz chart.</p>
<ul>
<li>
<code>Blue</code>: the MAPE is zero or near zero</li>
<li>
<code>Yellow</code>: the MAPE is around 10 percent.</li>
<li>
<code>Red</code>: the MAPE has reached 25%.</li>
<li>
<code>Grey</code>: the mean absolute percentage error is above or way above 25%.</li>
</ul>
<p>You can see for yourself which correlation is more stable at different ranges of pseudo-reduce pressures and temperatures.</p>
<div id="beggs-brill" class="section level4">
<h4 class="hasAnchor">
<a href="#beggs-brill" class="anchor"></a>Beggs-Brill</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
zFactor<span class="op">:::</span><span class="kw"><a href="reference/z.plot.range.html">z.plot.range</a></span>(<span class="st">"BB"</span>,  <span class="dt">interval =</span> <span class="st">"fine"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="hall-yarborough" class="section level4">
<h4 class="hasAnchor">
<a href="#hall-yarborough" class="anchor"></a>Hall-Yarborough</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zFactor<span class="op">:::</span><span class="kw"><a href="reference/z.plot.range.html">z.plot.range</a></span>(<span class="st">"HY"</span>,  <span class="dt">interval =</span> <span class="st">"fine"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zFactor<span class="op">:::</span><span class="kw"><a href="reference/z.plot.range.html">z.plot.range</a></span>(<span class="st">"HY"</span>,  <span class="dt">interval =</span> <span class="st">"coarse"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-2.png" width="672"></p>
</div>
<div id="dranchuk-aboukassem" class="section level4">
<h4 class="hasAnchor">
<a href="#dranchuk-aboukassem" class="anchor"></a>Dranchuk-AbouKassem</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zFactor<span class="op">:::</span><span class="kw"><a href="reference/z.plot.range.html">z.plot.range</a></span>(<span class="st">"DAK"</span>, <span class="dt">interval =</span> <span class="st">"fine"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="672"></p>
</div>
<div id="dranchuk-purvis-robinson" class="section level4">
<h4 class="hasAnchor">
<a href="#dranchuk-purvis-robinson" class="anchor"></a>Dranchuk-Purvis-Robinson</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zFactor<span class="op">:::</span><span class="kw"><a href="reference/z.plot.range.html">z.plot.range</a></span>(<span class="st">"DPR"</span>, <span class="dt">interval =</span> <span class="st">"fine"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="672"></p>
</div>
<div id="shell-shell-oil-company" class="section level4">
<h4 class="hasAnchor">
<a href="#shell-shell-oil-company" class="anchor"></a>Shell (Shell Oil Company)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zFactor<span class="op">:::</span><span class="kw"><a href="reference/z.plot.range.html">z.plot.range</a></span>(<span class="st">"SH"</span>,  <span class="dt">interval =</span> <span class="st">"fine"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="ann10-neural-network-10-neurons" class="section level4">
<h4 class="hasAnchor">
<a href="#ann10-neural-network-10-neurons" class="anchor"></a>Ann10 (Neural Network, 10 neurons)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zFactor<span class="op">:::</span><span class="kw"><a href="reference/z.plot.range.html">z.plot.range</a></span>(<span class="st">"N10"</span>, <span class="dt">interval =</span> <span class="st">"fine"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="672"></p>
</div>
<div id="papp-explicit" class="section level4">
<h4 class="hasAnchor">
<a href="#papp-explicit" class="anchor"></a>Papp (explicit)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zFactor<span class="op">:::</span><span class="kw"><a href="reference/z.plot.range.html">z.plot.range</a></span>(<span class="st">"PP"</span>,  <span class="dt">interval =</span> <span class="st">"fine"</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="672"></p>
</div>
</div>
<div id="comparative-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#comparative-analysis" class="anchor"></a>Comparative Analysis</h2>
<p>The comparative analysis shows tables with different error measurements:</p>
<pre><code>MSE:   Mean Squared Error
RMSE:  Root Mean Squared Error
RSS:   Residual sum of Squares
RMSLE: Root Mean Squared Logarithmic Error. Penalizes understimation.
MAPE:  Mean Absolute Percentage Error = AARE
MPE:   Mean Percentage error = ARE
MAE:   Mean Absolute Error
MAAPE: Mean Arc-tangent Absolute Percentage Error</code></pre>
<blockquote>
<p>MAAPE was proposed by <code>[@Kim2016]</code>. Other authors consulted for the error measures are <code>[@Makridakis1993]</code>, <code>[@Chen2017]</code>, <code>[@Kobayashi2000]</code>, <code>[@Myttenaere2016]</code>, <code>[@Syntetos2013]</code>, and <code>[@Armstrong1992]</code>.</p>
</blockquote>
</div>
<div id="what-you-can-do-with-zfactor" class="section level2">
<h2 class="hasAnchor">
<a href="#what-you-can-do-with-zfactor" class="anchor"></a>What you can do with <code>zFactor</code>
</h2>
<ul>
<li>Find <code>z</code> with any of the correlations provided</li>
<li>Get values from the Standing-Katz chart at any of the isotherms limited by the pseudo-reduced pressures (<code>Ppr</code>) digitized</li>
<li>Find what isotherms or pseudo-reduced temperatures (<code>Tpr</code>) are available from the Standing and Katz chart</li>
<li>Find what pseudo-reduced pressure points are available</li>
<li>Plot any of the Standing-Katz isotherms to view <code>z</code> in graphical form</li>
<li>Plot a tile chart to show the range of applicability of the correlations. In essence, get an idea of the accuracy by the location of the desired point at Tpr and Ppr</li>
<li>Get a statistics table when comparing any of the correlations to the Standing-Katz chart</li>
<li>Get a matrix of <code>z</code> values calculated from any correlation where the rows are the pseudo-reduced temperatures and the columns the pseudo-reduced pressures</li>
<li>Plot one or multiple isotherms</li>
</ul>
<div id="plotting-a-specific-isotherm-of-sk-chart" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-a-specific-isotherm-of-sk-chart" class="anchor"></a>Plotting a specific isotherm of SK chart</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="kw"><a href="reference/getStandingKatzCurve.html">getStandingKatzCurve</a></span>(<span class="dt">tpr =</span> <span class="fl">1.3</span>, <span class="dt">toView =</span> <span class="ot">FALSE</span>, <span class="dt">toSave =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="480"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/getStandingKatzCurve.html">getStandingKatzCurve</a></span>(<span class="dt">tpr =</span> <span class="fl">1.05</span>, <span class="dt">pprRange =</span> <span class="st">"lp"</span>, <span class="dt">toView =</span> <span class="ot">FALSE</span>, <span class="dt">toSave =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-2.png" width="480"></p>
</div>
<div id="ploting-all-the-tpr-curves-of-standing-katz-chart-using-lapply-getstandingkatzdata-and-data-tablerbindlist" class="section level3">
<h3 class="hasAnchor">
<a href="#ploting-all-the-tpr-curves-of-standing-katz-chart-using-lapply-getstandingkatzdata-and-data-tablerbindlist" class="anchor"></a>Ploting all the <code>Tpr</code> curves of Standing-Katz chart using <code>lapply</code>, <code>getStandingKatzData</code> and <code><a href="http://www.rdocumentation.org/packages/data.table/topics/rbindlist">data.table::rbindlist</a></code>:</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(data.table)

tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.6</span>, <span class="fl">1.7</span>, <span class="fl">1.9</span>, <span class="fl">2.0</span>, <span class="fl">2.4</span>, <span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">3.0</span>)
all_tpr2 &lt;-<span class="st"> </span>(<span class="kw">lapply</span>(tpr_vec, <span class="cf">function</span>(x) <span class="kw"><a href="reference/getStandingKatzData.html">getStandingKatzData</a></span>(<span class="dt">tpr =</span> x)))
<span class="kw">names</span>(all_tpr2) &lt;-<span class="st"> </span>tpr_vec

all_tpr_df &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(all_tpr2, <span class="dt">idcol =</span> <span class="ot">TRUE</span>)
<span class="kw">colnames</span>(all_tpr_df)[<span class="dv">1</span>] &lt;-<span class="st"> "Tpr"</span>

<span class="kw">ggplot</span>(all_tpr_df, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="672"></p>
</div>
<div id="build-a-table-of-statistical-errors-between-a-correlation-and-sk-chart" class="section level3">
<h3 class="hasAnchor">
<a href="#build-a-table-of-statistical-errors-between-a-correlation-and-sk-chart" class="anchor"></a>Build a table of statistical errors between a correlation and SK chart</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(tibble)
<span class="kw">library</span>(dplyr)

<span class="co"># get all Tpr curves at low pressure (lp)</span>
tpr_all &lt;-<span class="st"> </span><span class="kw"><a href="reference/getStandingKatzTpr.html">getStandingKatzTpr</a></span>(<span class="dt">pprRange =</span> <span class="st">"lp"</span>)
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 
sk_corr_all &lt;-<span class="st"> </span><span class="kw"><a href="reference/createTidyFromMatrix.html">createTidyFromMatrix</a></span>(ppr, tpr_all, <span class="dt">correlation =</span> <span class="st">"DPR"</span>)
grouped &lt;-<span class="st"> </span><span class="kw">group_by</span>(sk_corr_all, Tpr, Ppr)

smry_tpr_ppr &lt;-<span class="st"> </span><span class="kw">summarise</span>(grouped, 
          <span class="dt">RMSE  =</span> <span class="kw">sqrt</span>(<span class="kw">mean</span>((z.chart<span class="op">-</span>z.calc)<span class="op">^</span><span class="dv">2</span>)), 
          <span class="dt">MPE   =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),
          <span class="dt">MAPE  =</span> <span class="kw">sum</span>(<span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(), 
          <span class="dt">MSE   =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart)<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(), 
          <span class="dt">RSS   =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart)<span class="op">^</span><span class="dv">2</span>),
          <span class="dt">MAE   =</span> <span class="kw">sum</span>(<span class="kw">abs</span>(z.calc <span class="op">-</span><span class="st"> </span>z.chart)) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),
          <span class="dt">RMLSE =</span> <span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">n</span>()<span class="op">*</span><span class="kw">sum</span>((<span class="kw">log</span>(z.calc <span class="op">+</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">log</span>(z.chart <span class="op">+</span><span class="dv">1</span>))<span class="op">^</span><span class="dv">2</span>))
          )
<span class="kw">as.tibble</span>(smry_tpr_ppr)
<span class="co">#&gt; # A tibble: 112 x 9</span>
<span class="co">#&gt; # Groups:   Tpr [?]</span>
<span class="co">#&gt;      Tpr   Ppr         RMSE        MPE       MAPE          MSE</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1  1.05   0.5 0.0009756528  0.1176903  0.1176903 9.518984e-07</span>
<span class="co">#&gt;  2  1.05   1.5 0.0319670358 12.6351920 12.6351920 1.021891e-03</span>
<span class="co">#&gt;  3  1.05   2.5 0.0444731970 12.9659466 12.9659466 1.977865e-03</span>
<span class="co">#&gt;  4  1.05   3.5 0.0361451067  7.6741203  7.6741203 1.306469e-03</span>
<span class="co">#&gt;  5  1.05   4.5 0.0271306123  4.5368917  4.5368917 7.360701e-04</span>
<span class="co">#&gt;  6  1.05   5.5 0.0137256422  1.8879838  1.8879838 1.883933e-04</span>
<span class="co">#&gt;  7  1.05   6.5 0.0080944856  0.9567950  0.9567950 6.552070e-05</span>
<span class="co">#&gt;  8   1.1   0.5 0.0026367700  0.3087553  0.3087553 6.952556e-06</span>
<span class="co">#&gt;  9   1.1   1.5 0.0169389191  3.9762721  3.9762721 2.869270e-04</span>
<span class="co">#&gt; 10   1.1   2.5 0.0190546763  4.8485181  4.8485181 3.630807e-04</span>
<span class="co">#&gt; # ... with 102 more rows, and 3 more variables: RSS &lt;dbl&gt;, MAE &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RMLSE &lt;dbl&gt;</span></code></pre></div>
</div>
</div>
<div id="summary-of-mape-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-of-mape-statistics" class="anchor"></a>Summary of MAPE statistics</h2>
<p>This function shows a statistical summary of the Mean Absolute Percentage Error of all the correlations. We are taking the mean, maximum error, minimum eroor, the median and the mode in the whole range of each opf the correlations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="kw"><a href="reference/stats_of_z.stats.html">stats_of_z.stats</a></span>()
<span class="co">#&gt;                 BB           HY          DAK         DPR         SH</span>
<span class="co">#&gt; mean    13.8862628  0.818657798  0.769721132  0.81237862  4.1530402</span>
<span class="co">#&gt; max    554.1872335 22.481448009 12.777908779 12.96594664 30.3942954</span>
<span class="co">#&gt; min      0.0153618  0.002422012  0.000609287  0.02057809  0.0231023</span>
<span class="co">#&gt; median   1.0402029  0.220154744  0.245336341  0.26714131  1.1092930</span>
<span class="co">#&gt; Mode     0.4281138  0.418077023  0.128870880  0.11769033  0.4389189</span>
<span class="co">#&gt;                N10           PP</span>
<span class="co">#&gt; mean   0.163515716  2.098729377</span>
<span class="co">#&gt; max    1.153159851 85.482666496</span>
<span class="co">#&gt; min    0.007209524  0.000507908</span>
<span class="co">#&gt; median 0.123437923  0.670820910</span>
<span class="co">#&gt; Mode   0.419773370  0.559623816</span></code></pre></div>
</div>
<div id="vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#vignettes" class="anchor"></a>Vignettes</h2>
<p>The vignettes contain examples on the use and analysis of the various correlations.</p>
<ul>
<li>StandingKatz_chart.Rmd</li>
<li>Beggs-Brill.Rmd</li>
<li>Hall-Yarborough.Rmd</li>
<li>Dranchuk-AbouKassem.Rmd</li>
<li>Dranchuk-Purvis-Robinson.Rmd</li>
<li>shell.Rmd</li>
<li>ANN.Rmd</li>
<li>Papp.Rmd</li>
</ul>
</div>
<div id="tests" class="section level2">
<h2 class="hasAnchor">
<a href="#tests" class="anchor"></a>Tests</h2>
<p>There are unit tests for the correlations under tests/testthat.</p>
</div>
<div id="how-the-standing-katz-chart-was-constructed" class="section level2">
<h2 class="hasAnchor">
<a href="#how-the-standing-katz-chart-was-constructed" class="anchor"></a>How the Standing-Katz chart was constructed</h2>
<p>The Standing-Katz (SK) chart data has been read directly from a scanned figure of the original plot drawn by Standing and Katz in 1951. The software used to digitize the data is <code>graphClick</code> for the operating system <code>osX</code> by Apple. This software has been tested and qualified by scolars working on a similar task of digitizing data. <code>[@Rakap2016]</code></p>
<p>Each one of the SK chart pseudo-reduce temperature curves has been digitized. There are some curves where more points were taken to describe the curvature better. Other curves are almost linear and few points were necessary to define the curve.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>The following books and papers were consulted during the development of this package:</p>
<p>[1] B. D. Al-Anazi, G. Pazuki, M. Nikookar, et al. “The prediction of the compressibility factor of sour and natural gas by an artificial neural network system”. In: <em>Petroleum Science and Technology</em> 29.4 (2011), pp. 325-336. DOI: 10.1080/10916460903330080. &lt;URL: <a href="http://doi.org/10.1080/10916460903330080" class="uri">http://doi.org/10.1080/10916460903330080</a>&gt;.</p>
<p>[2] J. C. de Almeida, J. A. VelÃÂ¡squez and R. Barbieri. “A Methodology for Calculating the Natural Gas Compressibility Factor for a Distribution Network”. In: <em>Petroleum Science and Technology</em> 32.21 (2014), pp. 2616-2624. DOI: 10.1080/10916466.2012.755194. eprint: <a href="http://dx.doi.org/10.1080/10916466.2012.755194" class="uri">http://dx.doi.org/10.1080/10916466.2012.755194</a>. &lt;URL: <a href="http://dx.doi.org/10.1080/10916466.2012.755194" class="uri">http://dx.doi.org/10.1080/10916466.2012.755194</a>&gt;.</p>
<p>[3] J. Armstrong and F. Collopy. “Error measures for generalizing about forecasting methods: Empirical comparisons”. In: <em>International Journal of Forecasting</em> 8.1 (Jun. 1992), pp. 69-80. DOI: 10.1016/0169-2070(92)90008-w. &lt;URL: <a href="https://doi.org/10.1016/0169-2070(92)90008-W" class="uri">https://doi.org/10.1016/0169-2070(92)90008-W</a>&gt;.</p>
<p>[4] I. M. Azizi N. Behbahani R. “An efficient correlation for calculating compressibility factor of natural gases”. In: <em>Journal of Natural Gas Chemistry</em> Volume 19.Issue 6, 2010, (2010), pp. 642-645. DOI: 10.1016/S1003-9953(09)60081-5. &lt;URL: <a href="http://doi.org/10.1016/S1003-9953(09)60081-5" class="uri">http://doi.org/10.1016/S1003-9953(09)60081-5</a>&gt;.</p>
<p>[5] A. Bahadori. <em>Fluid Phase Behavior for Conventional and Unconventional Oil and Gas Reservoirs</em>. ISBN 978-0-12-803437-8. Houston, Texas: Gulf Publishing, 2016. &lt;URL: <a href="https://books.google.com/books?id=BwXeDAAAQBAJ" class="uri">https://books.google.com/books?id=BwXeDAAAQBAJ</a>&gt;.</p>
<p>[6] C. Chen, J. Twycross and J. M. Garibaldi. “A new accuracy measure based on bounded relative error for time series forecasting”. In: <em>PLOS ONE</em> 12.3 (Mar. 2017). Ed. by Z. Gao, p. e0174202. DOI: 10.1371/journal.pone.0174202. &lt;URL: <a href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0174202" class="uri">http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0174202</a>&gt;.</p>
<p>[7] P. M. Dranchuk and H. Abou-Kassem. “Calculation of Z Factors For Natural Gases Using Equations of State”. In: <em>Journal of Canadian Petroleum Technology</em> (Jul. 1975). DOI: 10.2118/75-03-03. &lt;URL: <a href="https://doi.org/10.2118/75-03-03" class="uri">https://doi.org/10.2118/75-03-03</a>&gt;.</p>
<p>[8] P. M. Dranchuk, R. Purvis, D. Robinson, et al. “Computer calculation of natural gas compressibility factors using the Standing and Katz correlation”. In: <em>Annual Technical Meeting</em>. Ed. by unknown. Petroleum Society of Canada. 1973. DOI: 10.2118/73-112. &lt;URL: <a href="http://doi.org/10.2118/73-112" class="uri">http://doi.org/10.2118/73-112</a>&gt;.</p>
<p>[9] K. R. Hall and L. Yarborough. “A new equation of state for Z-factor calculations”. In: <em>Oil and Gas journal</em> 71.7 (1973), pp. 82-92.</p>
<p>[10] M. Kamyab, J. H. Sampaio, F. Qanbari, et al. “Using artificial neural networks to estimate the z-factor for natural hydrocarbon gases”. In: <em>Journal of Petroleum Science and Engineering</em> 73.3 (2010), pp. 248-257. DOI: 10.1016/j.petrol.2010.07.006. &lt;URL: <a href="http://doi.org/10.1016/j.petrol.2010.07.006" class="uri">http://doi.org/10.1016/j.petrol.2010.07.006</a>&gt;.</p>
<p>[11] S. Kim and H. Kim. “A new metric of absolute percentage error for intermittent demand forecasts”. In: <em>International Journal of Forecasting</em> 32.3 (Jul. 2016), pp. 669-679. DOI: 10.1016/j.ijforecast.2015.12.003. &lt;URL: <a href="https://doi.org/10.1016/j.ijforecast.2015.12.003" class="uri">https://doi.org/10.1016/j.ijforecast.2015.12.003</a>&gt;.</p>
<p>[12] K. Kobayashi and M. U. Salam. “Comparing Simulated and Measured Values Using Mean Squared Deviation and its Components”. In: <em>Agronomy Journal</em> 92.2 (2000), p. 345. DOI: 10.1007/s100870050043. &lt;URL: <a href="https://www.researchgate.net/publication/243112181_Comparing_Simulated_and_Measured_Values_Using_Mean_Squared_Deviation_and_Its_Components" class="uri">https://www.researchgate.net/publication/243112181_Comparing_Simulated_and_Measured_Values_Using_Mean_Squared_Deviation_and_Its_Components</a>&gt;.</p>
<p>[13] N. Kumar. “Compressibility factors for natural and sour reservoir gases by correlations and cubic equations of state”. MA Thesis. Texas Tech University, 2004. &lt;URL: <a href="https://ttu-ir.tdl.org/ttu-ir/handle/2346/1370" class="uri">https://ttu-ir.tdl.org/ttu-ir/handle/2346/1370</a>&gt;.</p>
<p>[14] S. Makridakis. “Accuracy measures: theoretical and practical concerns”. In: <em>International Journal of Forecasting</em> 9.4 (Dec. 1993), pp. 527-529. DOI: 10.1016/0169-2070(93)90079-3. &lt;URL: <a href="https://www.sciencedirect.com/science/article/pii/0169207093900793" class="uri">https://www.sciencedirect.com/science/article/pii/0169207093900793</a>&gt;.</p>
<p>[15] M. Mohamadi-Baghmolaei, R. Azin, S. Osfouri, et al. “Prediction of gas compressibility factor using intelligent models”. In: <em>Natural Gas Industry B</em> 2.4 (2015), pp. 283-294. DOI: 10.1016/j.ngib.2015.09.001. &lt;URL: <a href="http://doi.org/10.1016/j.ngib.2015.09.001" class="uri">http://doi.org/10.1016/j.ngib.2015.09.001</a>&gt;.</p>
<p>[16] A. de Myttenaere, B. Golden, B. L. Grand, et al. “Mean Absolute Percentage Error for regression models”. In: <em>Neurocomputing</em> 192 (Jun. 2016), pp. 38-48. DOI: 10.1016/j.neucom.2015.12.114. &lt;URL: <a href="https://doi.org/10.1016/j.neucom.2015.12.114" class="uri">https://doi.org/10.1016/j.neucom.2015.12.114</a>&gt;.</p>
<p>[17] I. Papp. “Uj modszer foldgazok elteresi tenyezojenek szamitasara”. In: <em>Koolaj es Foldgaz</em> (Nov. 1979), pp. 345-47.</p>
<p>[18] S. Rakap, S. Rakap, D. Evran, et al. “Comparative evaluation of the reliability and validity of three data extraction programs: UnGraph, GraphClick, and DigitizeIt”. In: <em>Computers in Human Behavior</em> 55 (2016), pp. 159-166. DOI: 10.1016/j.chb.2015.09.008. &lt;URL: <a href="http://doi.org/10.1016/j.chb.2015.09.008" class="uri">http://doi.org/10.1016/j.chb.2015.09.008</a>&gt;.</p>
<p>[19] A. Syntetos, D. Lengu and M. Z. Babai. “A note on the demand distributions of spare parts”. In: <em>International Journal of Production Research</em> 51.21 (Nov. 2013), pp. 6356-6358. DOI: 10.1080/00207543.2013.798050.</p>
<p>[20] G. Takacs. “Comparing Methods for Calculating z Factor”. In: <em>Oil and Gas Journal</em> (May. 1989). DOI: Not Available. &lt;URL: <a href="https://www.researchgate.net/publication/236510717_Comparing_methods_for_calculating_Z-factor" class="uri">https://www.researchgate.net/publication/236510717_Comparing_methods_for_calculating_Z-factor</a>&gt;.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=zFactor">https://​cran.r-project.org/​package=zFactor</a>
</li>
<li>Browse source code at <br><a href="https://github.com/f0nzie/zFactor">https://​github.com/​f0nzie/​zFactor</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Alfonso R. Reyes <br><small class="roles"> Author, maintainer </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=zFactor"><img src="http://www.r-pkg.org/badges/version/zFactor" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://travis-ci.org/f0nzie/zFactor"><img src="https://travis-ci.org/f0nzie/zFactor.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://codecov.io/gh/f0nzie/zFactor"><img src="https://codecov.io/gh/f0nzie/zFactor/branch/master/graph/badge.svg" alt="codecov"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alfonso R. Reyes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
