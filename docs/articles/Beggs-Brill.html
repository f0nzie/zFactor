<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Beggs-Brill correlation • zFactor</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">zFactor</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Ann10.html">Artificial Neural Network correlation</a>
    </li>
    <li>
      <a href="../articles/Beggs-Brill.html">Beggs-Brill correlation</a>
    </li>
    <li>
      <a href="../articles/Dranchuk-AbouKassem.html">Dranchuk-AbouKassem correlation</a>
    </li>
    <li>
      <a href="../articles/Dranchuk-Purvis-Robinson.html">Dranchuk-Purvis-Robinson correlation</a>
    </li>
    <li>
      <a href="../articles/Hall-Yarborough.html">Hall-Yarborough correlation</a>
    </li>
    <li>
      <a href="../articles/Plot_StandingKatz_lp.html">Plot Standing-Katz low-pressure `lp` charts</a>
    </li>
    <li>
      <a href="../articles/Shell.html">Shell correlation</a>
    </li>
    <li>
      <a href="../articles/StandingKatz_chart.html">Standing-Katz chart data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/f0nzie/zFactor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Beggs-Brill correlation</h1>
                        <h4 class="author">Vignette Author</h4>
            
            <h4 class="date">2017-10-08</h4>
          </div>

    
    
<div class="contents">
<div id="how-do-we-find-the-limits-of-accuracy-in-the-bb-correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#how-do-we-find-the-limits-of-accuracy-in-the-bb-correlation" class="anchor"></a>How do we find the limits of accuracy in the <code>BB</code> correlation</h2>
</div>
<div id="get-z-at-selected-ppr-and-tpr" class="section level2">
<h2 class="hasAnchor">
<a href="#get-z-at-selected-ppr-and-tpr" class="anchor"></a>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code>
</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value using DPR correlation</span>
<span class="kw">library</span>(zFactor)

<span class="kw"><a href="../reference/Beggs-Brill.html">z.BeggsBrill</a></span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">2.0</span>)
<span class="co"># HY = 0.9580002</span></code></pre></div>
<pre><code>[1] 0.962902</code></pre>
<p>From the Standing-Katz chart we obtain a digitized point at the same <code>Ppr</code> and <code>Tpr</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value from the SK chart at the same Ppr and Tpr</span>
<span class="kw">library</span>(zFactor)

tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.0</span>)
<span class="kw"><a href="../reference/getStandingKatzMatrix.html">getStandingKatzMatrix</a></span>(<span class="dt">tpr_vector =</span> tpr_vec, 
                      <span class="dt">pprRange =</span> <span class="st">"lp"</span>)[<span class="dv">1</span>, <span class="st">"1.5"</span>]</code></pre></div>
<pre><code>  1.5 
0.956 </code></pre>
<p>It looks pretty good.</p>
</div>
<div id="get-z-at-selected-ppr-and-tpr-1" class="section level2">
<h2 class="hasAnchor">
<a href="#get-z-at-selected-ppr-and-tpr-1" class="anchor"></a>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code>
</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="kw"><a href="../reference/Beggs-Brill.html">z.BeggsBrill</a></span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">1.1</span>)</code></pre></div>
<pre><code>[1] 0.4631501</code></pre>
<p>From the <code>Standing-Katz</code> chart we obtain a digitized point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.1</span>)
<span class="kw"><a href="../reference/getStandingKatzMatrix.html">getStandingKatzMatrix</a></span>(<span class="dt">tpr_vector =</span> tpr_vec, 
                      <span class="dt">pprRange =</span> <span class="st">"lp"</span>)[<span class="dv">1</span>, <span class="st">"1.5"</span>]</code></pre></div>
<pre><code>  1.5 
0.426 </code></pre>
<blockquote>
<p>At lower <code>Tpr</code> there is some error. We see a difference between the values of z from the `BB calculation and the value read from the Standing-Katz chart.</p>
</blockquote>
</div>
<div id="get-values-of-z-for-several-ppr-and-tpr" class="section level2">
<h2 class="hasAnchor">
<a href="#get-values-of-z-for-several-ppr-and-tpr" class="anchor"></a>Get values of <code>z</code> for several <code>Ppr</code> and <code>Tpr</code>
</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test HY with 1st-derivative using the values from paper </span>
 
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 
tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="dv">2</span>) 
 
corr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Beggs-Brill.html">z.BeggsBrill</a></span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)
<span class="kw">print</span>(corr)

<span class="co"># From Hall-Yarborough</span>
<span class="co">#    0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co"># 1.3 0.9176300 0.7534433 0.6399020 0.6323003 0.6881127 0.7651710 0.8493794</span>
<span class="co"># 1.5 0.9496855 0.8581232 0.7924067 0.7687902 0.7868071 0.8316848 0.8906351</span>
<span class="co"># 1.7 0.9682547 0.9134862 0.8756412 0.8605668 0.8694525 0.8978885 0.9396353</span>
<span class="co"># 2   0.9838234 0.9580002 0.9426939 0.9396286 0.9490995 0.9697839 0.9994317</span>

<span class="co"># From Dranchuk-AbouKassem</span>
<span class="co">#  0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co"># 1.3 0.9203019 0.7543694 0.6377871 0.6339357 0.6898314 0.7663247 0.8499523</span>
<span class="co"># 1.5 0.9509373 0.8593144 0.7929993 0.7710525 0.7896224 0.8331893 0.8904317</span>
<span class="co"># 1.7 0.9681353 0.9128087 0.8753784 0.8619509 0.8721085 0.9003962 0.9409634</span>
<span class="co"># 2   0.9824731 0.9551087 0.9400752 0.9385273 0.9497137 0.9715388 1.0015560</span></code></pre></div>
<pre><code>          0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.3 0.9266436 0.7675523 0.6526911 0.6234648 0.6921991 0.7779095 0.8630653
1.5 0.9555248 0.8618306 0.7945385 0.7691830 0.7828753 0.8248905 0.8837555
1.7 0.9719193 0.9159219 0.8728791 0.8521620 0.8556641 0.8800665 0.9198223
2   0.9853337 0.9629020 0.9471826 0.9404180 0.9443010 0.9593080 0.9848256</code></pre>
<p>With the same <code>ppr</code> and <code>tpr</code> vectors, we do the same for the Standing-Katz chart:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

sk &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getStandingKatzMatrix.html">getStandingKatzMatrix</a></span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)
<span class="kw">print</span>(sk)</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 0.916 0.756 0.638 0.633 0.684 0.759 0.844
1.50 0.948 0.859 0.794 0.770 0.790 0.836 0.892
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003</code></pre>
<p>Subtract the two matrices and find the difference:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err &lt;-<span class="st"> </span><span class="kw">round</span>((sk -<span class="st"> </span>corr) /<span class="st"> </span>sk *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)
err

<span class="co"># DAK</span>
<span class="co"># 0.5   1.5  2.5   3.5   4.5   5.5   6.5</span>
<span class="co"># 1.30 -0.47  0.22 0.03 -0.15 -0.85 -0.97 -0.71</span>
<span class="co"># 1.50 -0.31 -0.04 0.13 -0.14  0.05  0.34  0.18</span>
<span class="co"># 1.70 -0.01  0.13 0.07 -0.58 -0.94 -0.38  0.11</span>
<span class="co"># 2.00 -0.05  0.09 0.10 -0.16 -0.50 -0.26  0.14</span></code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 -1.16 -1.53 -2.30  1.51 -1.20 -2.49 -2.26
1.50 -0.79 -0.33 -0.07  0.11  0.90  1.33  0.92
1.70 -0.40 -0.21  0.36  0.56  0.96  1.89  2.35
2.00 -0.34 -0.72 -0.66 -0.36  0.07  1.00  1.81</code></pre>
</div>
<div id="error-by-ppr-and-by-ppr" class="section level2">
<h2 class="hasAnchor">
<a href="#error-by-ppr-and-by-ppr" class="anchor"></a>Error by <code>Ppr</code> and by <code>PPr</code>
</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">colSums</span>(err))</code></pre></div>
<pre><code>  0.5   1.5   2.5   3.5   4.5   5.5   6.5 
-2.69 -2.79 -2.67  1.82  0.73  1.73  2.82 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">rowSums</span>(err))</code></pre></div>
<pre><code> 1.30  1.50  1.70  2.00 
-9.43  2.07  5.51  0.80 </code></pre>
</div>
<div id="analyze-the-error-for-smaller-values-of-tpr" class="section level2">
<h2 class="hasAnchor">
<a href="#analyze-the-error-for-smaller-values-of-tpr" class="anchor"></a>Analyze the error for smaller values of <code>Tpr</code>
</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>) 

sk2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getStandingKatzMatrix.html">getStandingKatzMatrix</a></span>(<span class="dt">ppr_vector =</span> ppr2, <span class="dt">tpr_vector =</span> tpr2, <span class="dt">pprRange =</span> <span class="st">"lp"</span>)
sk2</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5
1.05 0.829 0.253 0.343 0.471 0.598 0.727
1.10 0.854 0.426 0.393 0.500 0.615 0.729</code></pre>
<p>We do the same with the <code>BB</code> correlation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate z values at lower values of Tpr</span>
<span class="kw">library</span>(zFactor)

corr2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Beggs-Brill.html">z.BeggsBrill</a></span>(<span class="dt">pres.pr =</span> ppr2, <span class="dt">temp.pr =</span> tpr2)
<span class="kw">print</span>(corr2)</code></pre></div>
<pre><code>           0.5       1.5       2.5       3.5       4.5       5.5
1.05 0.8325491 0.2851494 0.3333796 0.4569204 0.5802310 0.7033638
1.1  0.8639321 0.4631501 0.3848774 0.4993213 0.6131885 0.7266084</code></pre>
<p>Subtract the matrices and calculate the error in percentage:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err2 &lt;-<span class="st"> </span><span class="kw">round</span>((sk2 -<span class="st"> </span>corr2) /<span class="st"> </span>sk2 *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)
err2

<span class="co"># DAK</span>
<span class="co"># 0.5    1.5    2.5   3.5   4.5   5.5</span>
<span class="co"># 1.05 -0.13 -12.15 -12.78 -7.49 -4.34 -1.68</span>
<span class="co"># 1.10 -0.36  -4.79  -4.97 -3.56 -2.14 -1.21</span></code></pre></div>
<pre><code>       0.5    1.5  2.5  3.5  4.5  5.5
1.05 -0.43 -12.71 2.80 2.99 2.97 3.25
1.10 -1.16  -8.72 2.07 0.14 0.29 0.33</code></pre>
<p>Transposing the matrix with <code>Tpr</code> as columns and <code>Ppr</code> as rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t_err2 &lt;-<span class="st"> </span><span class="kw">t</span>(err2)
t_err2</code></pre></div>
<pre><code>      1.05  1.10
0.5  -0.43 -1.16
1.5 -12.71 -8.72
2.5   2.80  2.07
3.5   2.99  0.14
4.5   2.97  0.29
5.5   3.25  0.33</code></pre>
<p>A statistical summary by <code>Tpr</code> curve:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_t_err2 &lt;-<span class="st"> </span><span class="kw">summary</span>(t_err2)
sum_t_err2</code></pre></div>
<pre><code>      1.05               1.10       
 Min.   :-12.7100   Min.   :-8.720  
 1st Qu.:  0.3775   1st Qu.:-0.835  
 Median :  2.8850   Median : 0.215  
 Mean   : -0.1883   Mean   :-1.175  
 3rd Qu.:  2.9850   3rd Qu.: 0.320  
 Max.   :  3.2500   Max.   : 2.070  </code></pre>
<p>We can see that the errors in <code>z</code> with <code>DAK</code> are less than <code>HY</code> with a Min. :-12.7100 % and Max. : 3.2500 % for <code>Tpr = 1.05</code>, and a Min. :-8.720 % and Max. : 2.070 % for <code>Tpr = 1.10</code>.</p>
</div>
<div id="prepare-to-plot-sk-chart-vs-bb-correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-to-plot-sk-chart-vs-bb-correlation" class="anchor"></a>Prepare to plot <code>SK</code> chart vs <code>BB</code> correlation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="kw">library</span>(tibble)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>) 

sk_corr_2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/createTidyFromMatrix.html">createTidyFromMatrix</a></span>(ppr2, tpr2, <span class="dt">correlation =</span> <span class="st">"BB"</span>)
<span class="kw">as.tibble</span>(sk_corr_2)</code></pre></div>
<pre><code># A tibble: 52 x 5
     Tpr   Ppr z.chart    z.calc          dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
 1  1.05   0.5   0.829 0.8325491 -0.003549064
 2   1.1   0.5   0.854 0.8639321 -0.009932126
 3   1.2   0.5   0.893 0.9026461 -0.009646136
 4   1.3   0.5   0.916 0.9266436 -0.010643559
 5  1.05   1.0   0.589 0.5857006  0.003299370
 6   1.1   1.0   0.669 0.6873576 -0.018357590
 7   1.2   1.0   0.779 0.7898931 -0.010893124
 8   1.3   1.0   0.835 0.8445056 -0.009505581
 9  1.05   1.5   0.253 0.2851494 -0.032149397
10   1.1   1.5   0.426 0.4631501 -0.037150091
# ... with 42 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)

p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_2, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="Beggs-Brill_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="analysis-at-the-lowest-tpr" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-at-the-lowest-tpr" class="anchor"></a>Analysis at the lowest <code>Tpr</code>
</h2>
<p>Extract only values at <code>Tpr = 1.05</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_corr_3 &lt;-<span class="st"> </span>sk_corr_3[sk_corr_3$Tpr==<span class="fl">1.05</span>,]</code></pre></div>
<pre><code>Error in eval(expr, envir, enclos): object 'sk_corr_3' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_corr_3</code></pre></div>
<pre><code>Error in eval(expr, envir, enclos): object 'sk_corr_3' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_3, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">fill =</span> <span class="st">"white"</span>, <span class="dt">size =</span> <span class="dv">3</span>) +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span><span class="fl">0.2</span>, <span class="dt">size =</span> <span class="dv">0</span>.,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">color =</span> <span class="st">"black"</span>)</code></pre></div>
<pre><code>Error in ggplot(sk_corr_3, aes(x = Ppr, y = z.calc, group = Tpr, color = Tpr)): object 'sk_corr_3' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(p)</code></pre></div>
<p><img src="Beggs-Brill_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sk_corr_3)</code></pre></div>
<pre><code>Error in summary(sk_corr_3): object 'sk_corr_3' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co">#         dif DAK      </span>
 <span class="co"># Min.   :-0.048404  </span>
 <span class="co"># 1st Qu.:-0.035300  </span>
 <span class="co"># Median :-0.025978  </span>
 <span class="co"># Mean   :-0.023178  </span>
 <span class="co"># 3rd Qu.:-0.009960  </span>
 <span class="co"># Max.   : 0.002325</span></code></pre></div>
<p>With this information there is no much we can say about Beggs-Brill.</p>
</div>
<div id="analyzing-performance-of-the-bb-correlation-for-all-the-tpr-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#analyzing-performance-of-the-bb-correlation-for-all-the-tpr-curves" class="anchor"></a>Analyzing performance of the <code>BB</code> correlation for all the <code>Tpr</code> curves</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(tibble)

<span class="co"># get all `lp` Tpr curves</span>
tpr_all &lt;-<span class="st"> </span><span class="kw">getCurvesDigitized</span>(<span class="dt">pprRange =</span> <span class="st">"lp"</span>)</code></pre></div>
<pre><code>Error in getCurvesDigitized(pprRange = "lp"): could not find function "getCurvesDigitized"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 

sk_corr_all &lt;-<span class="st"> </span><span class="kw"><a href="../reference/createTidyFromMatrix.html">createTidyFromMatrix</a></span>(ppr, tpr_all, <span class="dt">correlation =</span> <span class="st">"BB"</span>)</code></pre></div>
<pre><code>Error in tpr_vector %in% getStandingKatzTpr(pprRange): object 'tpr_all' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.tibble</span>(sk_corr_all)</code></pre></div>
<pre><code>Error in as.tibble(sk_corr_all): object 'sk_corr_all' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_all, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))</code></pre></div>
<pre><code>Error in ggplot(sk_corr_all, aes(x = Ppr, y = z.calc, group = Tpr, color = Tpr)): object 'sk_corr_all' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(p)</code></pre></div>
<p><img src="Beggs-Brill_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># MSE: Mean Squared Error</span>
<span class="co"># RMSE: Root Mean Sqyared Error</span>
<span class="co"># RSS: residual sum of square</span>
<span class="co"># ARE:  Average Relative Error, %</span>
<span class="co"># AARE: Average Absolute Relative Error, %</span>
<span class="kw">library</span>(dplyr)
grouped &lt;-<span class="st"> </span><span class="kw">group_by</span>(sk_corr_all, Tpr, Ppr)</code></pre></div>
<pre><code>Error in group_by(sk_corr_all, Tpr, Ppr): object 'sk_corr_all' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">smry_tpr_ppr &lt;-<span class="st"> </span><span class="kw">summarise</span>(grouped, 
          <span class="dt">RMSE=</span> <span class="kw">sqrt</span>(<span class="kw">mean</span>((z.chart-z.calc)^<span class="dv">2</span>)), 
          <span class="dt">MSE =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart)^<span class="dv">2</span>) /<span class="st"> </span><span class="kw">n</span>(), 
          <span class="dt">RSS =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart)^<span class="dv">2</span>),
          <span class="dt">ARE =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart) *<span class="st"> </span><span class="dv">100</span> /<span class="st"> </span><span class="kw">n</span>(),
          <span class="dt">AARE =</span> <span class="kw">sum</span>( <span class="kw">abs</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart)) *<span class="st"> </span><span class="dv">100</span> /<span class="st"> </span><span class="kw">n</span>()
          )</code></pre></div>
<pre><code>Error in summarise(grouped, RMSE = sqrt(mean((z.chart - z.calc)^2)), MSE = sum((z.calc - : object 'grouped' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(smry_tpr_ppr, <span class="kw">aes</span>(Ppr, Tpr)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>smry_tpr_ppr, <span class="kw">aes</span>(<span class="dt">fill=</span>AARE), <span class="dt">color=</span><span class="st">"white"</span>) +
<span class="st">    </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low=</span><span class="st">"blue"</span>, <span class="dt">high=</span><span class="st">"red"</span>, <span class="dt">mid=</span><span class="st">"yellow"</span>, <span class="dt">na.value =</span> <span class="st">"pink"</span>,
                         <span class="dt">midpoint=</span><span class="fl">12.5</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">name=</span><span class="st">"AARE"</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">vjust=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">11</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">coord_equal</span>() +
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">"Beggs-Brill"</span>, <span class="dt">subtitle =</span> <span class="st">"BB"</span>)</code></pre></div>
<pre><code>Error in ggplot(smry_tpr_ppr, aes(Ppr, Tpr)): object 'smry_tpr_ppr' not found</code></pre>
<blockquote>
<p>The errors with Beggs and Brill are just so big and some <code>z</code> values are even negative. We have to be very careful when using this Beggs and Brill correlation.</p>
</blockquote>
<p>Let’s see which observations (rows) have <code>z</code> values that are negative:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_corr_all[<span class="kw">which</span>(sk_corr_all$z.calc &lt;<span class="st"> </span><span class="dv">0</span>), ]</code></pre></div>
<pre><code>Error in eval(expr, envir, enclos): object 'sk_corr_all' not found</code></pre>
<p>Or see which rows contain <code>z</code> values that show an error greater than 15%:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_corr_all[<span class="kw">which</span>(<span class="kw">abs</span>(sk_corr_all$dif) &gt;<span class="st"> </span><span class="fl">0.15</span>), ]</code></pre></div>
<pre><code>Error in eval(expr, envir, enclos): object 'sk_corr_all' not found</code></pre>
<p>You can also see that there are three rows with error greater than 100% !</p>
</div>
<div id="looking-numerically-at-the-errors-in-bb-vs-sk-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#looking-numerically-at-the-errors-in-bb-vs-sk-chart" class="anchor"></a>Looking numerically at the errors in <code>BB</code> vs <code>SK</code> chart</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get all `lp` Tpr curves</span>
tpr &lt;-<span class="st"> </span><span class="kw">getCurvesDigitized</span>(<span class="dt">pprRange =</span> <span class="st">"lp"</span>)</code></pre></div>
<pre><code>Error in getCurvesDigitized(pprRange = "lp"): could not find function "getCurvesDigitized"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 

<span class="co"># calculate HY for the given Tpr</span>
all_corr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Beggs-Brill.html">z.BeggsBrill</a></span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)
<span class="kw">cat</span>(<span class="st">"Calculated from the correlation </span><span class="ch">\n</span><span class="st">"</span>)
<span class="kw">print</span>(all_corr) 

<span class="kw">cat</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Standing-Katz chart</span><span class="ch">\n</span><span class="st">"</span>)
all_sk &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getStandingKatzMatrix.html">getStandingKatzMatrix</a></span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)
all_sk

<span class="co"># find the error</span>
<span class="kw">cat</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Errors in percentage </span><span class="ch">\n</span><span class="st">"</span>)
all_err &lt;-<span class="st"> </span><span class="kw">round</span>((all_sk -<span class="st"> </span>all_corr) /<span class="st"> </span>all_sk *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)  <span class="co"># in percentage</span>
all_err

<span class="kw">cat</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Errors in Ppr</span><span class="ch">\n</span><span class="st">"</span>)
<span class="kw">summary</span>(all_err)

<span class="co"># for the transposed matrix</span>
<span class="kw">cat</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Errors for the transposed matrix: Tpr </span><span class="ch">\n</span><span class="st">"</span>)
<span class="kw">summary</span>(<span class="kw">t</span>(all_err))</code></pre></div>
<pre><code>Calculated from the correlation 
          0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.3 0.9266436 0.7675523 0.6526911 0.6234648 0.6921991 0.7779095 0.8630653
1.5 0.9555248 0.8618306 0.7945385 0.7691830 0.7828753 0.8248905 0.8837555
1.7 0.9719193 0.9159219 0.8728791 0.8521620 0.8556641 0.8800665 0.9198223
2   0.9853337 0.9629020 0.9471826 0.9404180 0.9443010 0.9593080 0.9848256

Standing-Katz chart
       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 0.916 0.756 0.638 0.633 0.684 0.759 0.844
1.50 0.948 0.859 0.794 0.770 0.790 0.836 0.892
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003

 Errors in percentage 
       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 -1.16 -1.53 -2.30  1.51 -1.20 -2.49 -2.26
1.50 -0.79 -0.33 -0.07  0.11  0.90  1.33  0.92
1.70 -0.40 -0.21  0.36  0.56  0.96  1.89  2.35
2.00 -0.34 -0.72 -0.66 -0.36  0.07  1.00  1.81

 Errors in Ppr
      0.5               1.5               2.5               3.5         
 Min.   :-1.1600   Min.   :-1.5300   Min.   :-2.3000   Min.   :-0.3600  
 1st Qu.:-0.8825   1st Qu.:-0.9225   1st Qu.:-1.0700   1st Qu.:-0.0075  
 Median :-0.5950   Median :-0.5250   Median :-0.3650   Median : 0.3350  
 Mean   :-0.6725   Mean   :-0.6975   Mean   :-0.6675   Mean   : 0.4550  
 3rd Qu.:-0.3850   3rd Qu.:-0.3000   3rd Qu.: 0.0375   3rd Qu.: 0.7975  
 Max.   :-0.3400   Max.   :-0.2100   Max.   : 0.3600   Max.   : 1.5100  
      4.5               5.5               6.5        
 Min.   :-1.2000   Min.   :-2.4900   Min.   :-2.260  
 1st Qu.:-0.2475   1st Qu.: 0.1275   1st Qu.: 0.125  
 Median : 0.4850   Median : 1.1650   Median : 1.365  
 Mean   : 0.1825   Mean   : 0.4325   Mean   : 0.705  
 3rd Qu.: 0.9150   3rd Qu.: 1.4700   3rd Qu.: 1.945  
 Max.   : 0.9600   Max.   : 1.8900   Max.   : 2.350  

 Errors for the transposed matrix: Tpr 
      1.30             1.50              1.70              2.00        
 Min.   :-2.490   Min.   :-0.7900   Min.   :-0.4000   Min.   :-0.7200  
 1st Qu.:-2.280   1st Qu.:-0.2000   1st Qu.: 0.0750   1st Qu.:-0.5100  
 Median :-1.530   Median : 0.1100   Median : 0.5600   Median :-0.3400  
 Mean   :-1.347   Mean   : 0.2957   Mean   : 0.7871   Mean   : 0.1143  
 3rd Qu.:-1.180   3rd Qu.: 0.9100   3rd Qu.: 1.4250   3rd Qu.: 0.5350  
 Max.   : 1.510   Max.   : 1.3300   Max.   : 2.3500   Max.   : 1.8100  </code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#how-do-we-find-the-limits-of-accuracy-in-the-bb-correlation">How do we find the limits of accuracy in the <code>BB</code> correlation</a></li>
      <li><a href="#get-z-at-selected-ppr-and-tpr">Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></a></li>
      <li><a href="#get-z-at-selected-ppr-and-tpr-1">Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></a></li>
      <li><a href="#get-values-of-z-for-several-ppr-and-tpr">Get values of <code>z</code> for several <code>Ppr</code> and <code>Tpr</code></a></li>
      <li><a href="#error-by-ppr-and-by-ppr">Error by <code>Ppr</code> and by <code>PPr</code></a></li>
      <li><a href="#analyze-the-error-for-smaller-values-of-tpr">Analyze the error for smaller values of <code>Tpr</code></a></li>
      <li><a href="#prepare-to-plot-sk-chart-vs-bb-correlation">Prepare to plot <code>SK</code> chart vs <code>BB</code> correlation</a></li>
      <li><a href="#analysis-at-the-lowest-tpr">Analysis at the lowest <code>Tpr</code></a></li>
      <li><a href="#analyzing-performance-of-the-bb-correlation-for-all-the-tpr-curves">Analyzing performance of the <code>BB</code> correlation for all the <code>Tpr</code> curves</a></li>
      <li><a href="#looking-numerically-at-the-errors-in-bb-vs-sk-chart">Looking numerically at the errors in <code>BB</code> vs <code>SK</code> chart</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alfonso Reyes R..</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
