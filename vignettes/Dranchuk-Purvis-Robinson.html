<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Vignette Author" />

<meta name="date" content="2017-06-27" />

<title>Dranchuk-Purvis-Robinson correlation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Dranchuk-Purvis-Robinson correlation</h1>
<h4 class="author"><em>Vignette Author</em></h4>
<h4 class="date"><em>2017-06-27</em></h4>



<div id="how-do-we-find-the-limits-of-accuracy-in-the-dpr-correlation" class="section level2">
<h2>How do we find the limits of accuracy in the <code>DPR</code> correlation</h2>
</div>
<div id="get-z-at-selected-ppr-and-tpr" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<p>Use the the corelation to calculate <code>z</code> and the Standing-Katz chart we obtain a digitized point at the given <code>Tpr</code> and <code>Ppr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value</span>
<span class="kw">library</span>(zFactor)

ppr &lt;-<span class="st"> </span><span class="fl">1.5</span>
tpr &lt;-<span class="st"> </span><span class="fl">2.0</span>

z.calc &lt;-<span class="st"> </span><span class="kw">z.DranchukPurvisRobinson</span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)

<span class="co"># get a z value from the SK chart at the same Ppr and Tpr</span>

z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr, 
                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="kw">as.character</span>(ppr)]


<span class="co"># calculate the APE</span>
ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart) *<span class="st"> </span><span class="dv">100</span>

df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">list</span>(<span class="dt">Ppr =</span> ppr,  <span class="dt">z.calc =</span>z.calc, <span class="dt">z.chart =</span> z.chart, <span class="dt">ape=</span>ape))
<span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>tpr
df
<span class="co"># HY = 0.9580002; # DAK = 0.9551087</span></code></pre></div>
<pre><code>  Ppr    z.calc z.chart       ape
2 1.5 0.9546382   0.956 0.1424501</code></pre>
</div>
<div id="get-z-at-selected-ppr-and-tpr1.1" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr=1.1</code></h2>
<p>From the Standing-Katz chart we obtain a digitized point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

ppr &lt;-<span class="st"> </span><span class="fl">1.5</span>
tpr &lt;-<span class="st"> </span><span class="fl">1.1</span>
z.calc &lt;-<span class="st"> </span><span class="kw">z.DranchukPurvisRobinson</span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)

<span class="co"># From the Standing-Katz chart we obtain a digitized point:</span>
z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr, 
                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="kw">as.character</span>(ppr)]

<span class="co"># calculate the APE</span>
ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart) *<span class="st"> </span><span class="dv">100</span>

df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">list</span>(<span class="dt">Ppr =</span> ppr,  <span class="dt">z.calc =</span>z.calc, <span class="dt">z.chart =</span> z.chart, <span class="dt">ape=</span>ape))
<span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>tpr
df</code></pre></div>
<pre><code>    Ppr    z.calc z.chart      ape
1.1 1.5 0.4429389   0.426 3.976272</code></pre>
<blockquote>
<p>At lower <code>Tpr</code> we can see that there is some difference between the values of z from the DPR calculation and the value read from the Standing-Katz chart.</p>
</blockquote>
</div>
<div id="get-values-of-z-for-combinations-of-ppr-and-tpr" class="section level2">
<h2>Get values of <code>z</code> for combinations of <code>Ppr</code> and <code>Tpr</code></h2>
<p>In this example we provide vectors instead of a single point. With the same <code>ppr</code> and <code>tpr</code> vectors that we use for the correlation, we do the same for the <code>Standing-Katz</code> chart. We want to compare both and find the <code>absolute percentage error</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test HY with 1st-derivative using the values from paper </span>
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 
tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.7</span>, <span class="dv">2</span>) 

<span class="co"># calculate using the correlation</span>
z.calc &lt;-<span class="st"> </span><span class="kw">z.DranchukPurvisRobinson</span>(ppr, tpr)

<span class="co"># With the same ppr and tpr vector, we do the same for the Standing-Katz chart</span>
z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)
ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart) *<span class="st"> </span><span class="dv">100</span>

<span class="co"># calculate the APE</span>
<span class="kw">cat</span>(<span class="st">&quot;z.correlation </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.calc)
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> z.chart </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.chart)
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> APE </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(ape)</code></pre></div>
<pre><code>z.correlation 
           0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.05 0.8299757 0.2849670 0.3874732 0.5071451 0.6251306 0.7407256 0.8540945
1.1  0.8566368 0.4429389 0.4120547 0.5173680 0.6278497 0.7376397 0.8458855
1.7  0.9677844 0.9121791 0.8752677 0.8630002 0.8743271 0.9033216 0.9440582
2    0.9822021 0.9546382 0.9399310 0.9391490 0.9512966 0.9740256 1.0047347

 z.chart 
       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.05 0.829 0.253 0.343 0.471 0.598 0.727 0.846
1.10 0.854 0.426 0.393 0.500 0.615 0.729 0.841
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003

 APE 
            0.5        1.5         2.5       3.5       4.5       5.5
1.05 0.11769033 12.6351920 12.96594664 7.6741203 4.5368917 1.8879838
1.1  0.30875526  3.9762721  4.84851814 3.4735929 2.0893900 1.1851375
1.7  0.02227128  0.1992260  0.08360117 0.7001396 1.1952693 0.7047482
2    0.02057809  0.1424501  0.11359921 0.2293483 0.6663029 0.5186423
           6.5
1.05 0.9567950
1.1  0.5809181
1.7  0.2184874
2    0.1729508</code></pre>
<blockquote>
<p>You can see errors of 12.64% and 12.97% in the isotherm <code>Tpr=1.05</code>. Other errors, greater than one, can also be found at the isotherm <code>Tpr=1.1</code>: 4.85%. Then, the rest of the <code>Tpr</code> curves are fine.</p>
</blockquote>
</div>
<div id="analyze-the-error-at-the-isotherms" class="section level2">
<h2>Analyze the error at the <code>isotherms</code></h2>
<p>Applying the function <code>summary</code> over the transpose of the matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_t_ape &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">t</span>(ape))
sum_t_ape</code></pre></div>
<pre><code>      1.05              1.1              1.7                2          
 Min.   : 0.1177   Min.   :0.3088   Min.   :0.02227   Min.   :0.02058  
 1st Qu.: 1.4224   1st Qu.:0.8830   1st Qu.:0.14141   1st Qu.:0.12802  
 Median : 4.5369   Median :2.0894   Median :0.21849   Median :0.17295  
 Mean   : 5.8249   Mean   :2.3518   Mean   :0.44625   Mean   :0.26627  
 3rd Qu.:10.1547   3rd Qu.:3.7249   3rd Qu.:0.70244   3rd Qu.:0.37400  
 Max.   :12.9659   Max.   :4.8485   Max.   :1.19527   Max.   :0.66630  </code></pre>
<blockquote>
<p>We can see that the errors at <code>Tpr=1.05</code> in <code>z</code> are considerable with a Min. : 0.1177 % and Max. :12.9659 %, and a Min. :0.3088 % and Max. :4.8485 % for <code>Tpr=1.10</code>. We will explore later a comparative <strong>tile</strong> chart where we confirm these early calculations.</p>
</blockquote>
</div>
<div id="analyze-the-error-for-greater-values-of-tpr" class="section level2">
<h2>Analyze the error for greater values of <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="co"># enter vectors for Tpr and Ppr</span>
tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.2</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>) 
<span class="co"># get z values from the SK chart</span>
z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr2, <span class="dt">tpr_vector =</span> tpr2, <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)

<span class="co"># We do the same with the HY correlation:</span>
<span class="co"># calculate z values at lower values of Tpr</span>
z.calc &lt;-<span class="st"> </span><span class="kw">z.DranchukPurvisRobinson</span>(<span class="dt">pres.pr =</span> ppr2, <span class="dt">temp.pr =</span> tpr2) 
ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart) *<span class="st"> </span><span class="dv">100</span>

<span class="co"># calculate the APE</span>
<span class="kw">cat</span>(<span class="st">&quot;z.correlation </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.calc)
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> z.chart </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.chart)
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> APE </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(ape)</code></pre></div>
<pre><code>z.correlation 
          0.5       1.5       2.5       3.5       4.5       5.5
1.2 0.8944622 0.6506542 0.5167723 0.5620069 0.6486093 0.7435619
1.3 0.9197157 0.7525940 0.6366665 0.6337883 0.6891997 0.7650171
1.5 0.9504834 0.8583491 0.7926325 0.7720713 0.7914322 0.8348883
2   0.9822021 0.9546382 0.9399310 0.9391490 0.9512966 0.9740256
3   0.9982332 0.9990423 1.0054940 1.0171291 1.0332788 1.0531986

 z.chart 
       0.5   1.5   2.5   3.5   4.5   5.5
1.20 0.893 0.657 0.519 0.565 0.650 0.741
1.30 0.916 0.756 0.638 0.633 0.684 0.759
1.50 0.948 0.859 0.794 0.770 0.790 0.836
2.00 0.982 0.956 0.941 0.937 0.945 0.969
3.00 1.002 1.009 1.018 1.029 1.041 1.056

 APE 
           0.5        1.5       2.5       3.5       4.5       5.5
1.2 0.16373952 0.96587736 0.4292331 0.5297522 0.2139491 0.3457414
1.3 0.40564053 0.45053093 0.2090095 0.1245350 0.7601879 0.7927605
1.5 0.26196479 0.07577742 0.1722264 0.2689942 0.1812966 0.1329789
2   0.02057809 0.14245011 0.1135992 0.2293483 0.6663029 0.5186423
3   0.37592424 0.98689063 1.2284915 1.1536378 0.7417116 0.2652884</code></pre>
<blockquote>
<p>We observe that at <code>Tpr</code> above or equal to 1.2 the <code>DAK</code> correlation behaves very well.</p>
</blockquote>
</div>
<div id="analyze-the-error-at-the-isotherms-1" class="section level2">
<h2>Analyze the error at the <code>isotherms</code></h2>
<p>Applying the function <code>summary</code> over the transpose of the matrix to observe the error of the correlation at each isotherm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_t_ape &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">t</span>(ape))
sum_t_ape
 <span class="co"># Hall-Yarborough</span>
 <span class="co">#      1.2               1.3              1.5               2         </span>
 <span class="co"># Min.   :0.05224   Min.   :0.1105   Min.   :0.1021   Min.   :0.0809  </span>
 <span class="co"># 1st Qu.:0.09039   1st Qu.:0.2080   1st Qu.:0.1623   1st Qu.:0.1814  </span>
 <span class="co"># Median :0.28057   Median :0.3181   Median :0.1892   Median :0.1975  </span>
 <span class="co"># Mean   :0.30122   Mean   :0.3899   Mean   :0.2597   Mean   :0.2284  </span>
 <span class="co"># 3rd Qu.:0.51710   3rd Qu.:0.5355   3rd Qu.:0.3533   3rd Qu.:0.2627  </span>
 <span class="co"># Max.   :0.57098   Max.   :0.8131   Max.   :0.5162   Max.   :0.4338  </span>
 <span class="co">#       3          </span>
 <span class="co"># Min.   :0.09128  </span>
 <span class="co"># 1st Qu.:0.17466  </span>
 <span class="co"># Median :0.35252  </span>
 <span class="co"># Mean   :0.34820  </span>
 <span class="co"># 3rd Qu.:0.52184  </span>
 <span class="co"># Max.   :0.59923  </span></code></pre></div>
<pre><code>      1.2              1.3              1.5                2          
 Min.   :0.1637   Min.   :0.1245   Min.   :0.07578   Min.   :0.02058  
 1st Qu.:0.2469   1st Qu.:0.2582   1st Qu.:0.14279   1st Qu.:0.12081  
 Median :0.3875   Median :0.4281   Median :0.17676   Median :0.18590  
 Mean   :0.4414   Mean   :0.4571   Mean   :0.18221   Mean   :0.28182  
 3rd Qu.:0.5046   3rd Qu.:0.6828   3rd Qu.:0.24180   3rd Qu.:0.44632  
 Max.   :0.9659   Max.   :0.7928   Max.   :0.26899   Max.   :0.66630  
       3         
 Min.   :0.2653  
 1st Qu.:0.4674  
 Median :0.8643  
 Mean   :0.7920  
 3rd Qu.:1.1120  
 Max.   :1.2285  </code></pre>
<p>We can see that the errors in <code>z</code> with <code>DPR</code> are far lower than <code>Hall-Yarborough</code> with a Min. :0.1637 % and Max. :0.9659 % for <code>Tpr=1.2</code>, and a Min. :0.1245 % and Max. :0.7928 % for <code>Tpr=1.3</code>.</p>
</div>
<div id="prepare-to-plot-sk-vs-dpr-correlation" class="section level2">
<h2>Prepare to plot SK vs DPR correlation</h2>
<p>The error bars represent the difference between the calculated values by the <code>Dranchuk-AbouKassem</code> corrrelation and teh values of <code>z</code> read from the Standing-Katz chart.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="kw">library</span>(tibble)
<span class="kw">library</span>(ggplot2)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>) 

sk_corr_2 &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr2, tpr2, <span class="dt">correlation =</span> <span class="st">&quot;DPR&quot;</span>)
<span class="kw">as.tibble</span>(sk_corr_2)


p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_2, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code># A tibble: 52 x 5
     Tpr   Ppr z.chart    z.calc           dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
 1  1.05   0.5   0.829 0.8299757 -0.0009756528
 2   1.1   0.5   0.854 0.8566368 -0.0026367700
 3   1.2   0.5   0.893 0.8944622 -0.0014621939
 4   1.3   0.5   0.916 0.9197157 -0.0037156673
 5  1.05   1.0   0.589 0.5856680  0.0033320375
 6   1.1   1.0   0.669 0.6758858 -0.0068857625
 7   1.2   1.0   0.779 0.7769542  0.0020457628
 8   1.3   1.0   0.835 0.8359886 -0.0009885692
 9  1.05   1.5   0.253 0.2849670 -0.0319670358
10   1.1   1.5   0.426 0.4429389 -0.0169389191
# ... with 42 more rows</code></pre>
<p>We observe that with <code>Dranchuk-Purvis-Robinson</code> there are still errors or differences between the <code>z</code> values in the Standing-Katz chart and the values obtained from the correlation but they are not so bad as in the HY correlation.</p>
</div>
<div id="analysis-at-the-lowest-tpr" class="section level2">
<h2>Analysis at the lowest <code>Tpr</code></h2>
<p>This is where we see the greatest error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

sk_corr_3 &lt;-<span class="st"> </span>sk_corr_2[sk_corr_2$Tpr==<span class="fl">1.05</span>,]
sk_corr_3


p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_3, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">2</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>    Tpr Ppr z.chart    z.calc           dif
1  1.05 0.5   0.829 0.8299757 -0.0009756528
5  1.05 1.0   0.589 0.5856680  0.0033320375
9  1.05 1.5   0.253 0.2849670 -0.0319670358
13 1.05 2.0   0.280 0.3290685 -0.0490685223
17 1.05 2.5   0.343 0.3874732 -0.0444731970
21 1.05 3.0   0.407 0.4473627 -0.0403627209
25 1.05 3.5   0.471 0.5071451 -0.0361451067
29 1.05 4.0   0.534 0.5664346 -0.0324345927
33 1.05 4.5   0.598 0.6251306 -0.0271306123
37 1.05 5.0   0.663 0.6832213 -0.0202213318
41 1.05 5.5   0.727 0.7407256 -0.0137256422
45 1.05 6.0   0.786 0.7976728 -0.0116727857
49 1.05 6.5   0.846 0.8540945 -0.0080944856</code></pre>
</div>
<div id="analyzing-performance-of-the-dpr-correlation-for-all-the-tpr-curves" class="section level2">
<h2>Analyzing performance of the <code>DPR</code> correlation for all the <code>Tpr</code> curves</h2>
<p>In this last example, we compare the values of <code>z</code> at all the isotherms. We use the function <code>getCurvesDigitized</code> to obtain all the isotherms or <code>Tpr</code> curves in the Standing-Katz chart that have been digitized. The next function <code>createTidyFromMatrix</code> calculate <code>z</code> using the correlation and prepares a tidy dataset ready to plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(tibble)

<span class="co"># get all `lp` Tpr curves</span>
tpr_all &lt;-<span class="st"> </span><span class="kw">getCurvesDigitized</span>(<span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 
sk_corr_all &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr, tpr_all, <span class="dt">correlation =</span> <span class="st">&quot;DPR&quot;</span>)
<span class="kw">as.tibble</span>(sk_corr_all)

p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_all, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code># A tibble: 112 x 5
     Tpr   Ppr z.chart    z.calc           dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
 1  1.05   0.5   0.829 0.8299757 -0.0009756528
 2   1.1   0.5   0.854 0.8566368 -0.0026367700
 3   1.2   0.5   0.893 0.8944622 -0.0014621939
 4   1.3   0.5   0.916 0.9197157 -0.0037156673
 5   1.4   0.5   0.936 0.9374909 -0.0014908703
 6   1.5   0.5   0.948 0.9504834 -0.0024834262
 7   1.6   0.5   0.959 0.9602585 -0.0012584586
 8   1.7   0.5   0.968 0.9677844  0.0002155860
 9   1.8   0.5   0.974 0.9736897  0.0003103086
10   1.9   0.5   0.978 0.9783976 -0.0003975858
# ... with 102 more rows</code></pre>
<blockquote>
<p>The greatest errors are localized in two of the Tpr curves: at 1.05 and 1.1.</p>
</blockquote>
</div>
<div id="range-of-applicability-of-the-correlation" class="section level2">
<h2>Range of applicability of the correlation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># MSE: Mean Squared Error</span>
<span class="co"># RMSE: Root Mean Squared Error</span>
<span class="co"># RSS: residual sum of square</span>
<span class="co"># ARE:  Average Relative Error, %</span>
<span class="co"># AARE: Average Absolute Relative Error, %</span>
<span class="kw">library</span>(dplyr)
grouped &lt;-<span class="st"> </span><span class="kw">group_by</span>(sk_corr_all, Tpr, Ppr)

smry_tpr_ppr &lt;-<span class="st"> </span><span class="kw">summarise</span>(grouped, 
          <span class="dt">RMSE=</span> <span class="kw">sqrt</span>(<span class="kw">mean</span>((z.chart-z.calc)^<span class="dv">2</span>)), 
          <span class="dt">MPE =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart) *<span class="st"> </span><span class="dv">100</span> /<span class="st"> </span><span class="kw">n</span>(),
          <span class="dt">MAPE =</span> <span class="kw">sum</span>(<span class="kw">abs</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart)) *<span class="st"> </span><span class="dv">100</span> /<span class="st"> </span><span class="kw">n</span>(), 
          <span class="dt">MSE =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart)^<span class="dv">2</span>) /<span class="st"> </span><span class="kw">n</span>(), 
          <span class="dt">RSS =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart)^<span class="dv">2</span>),
          <span class="dt">MAE =</span> <span class="kw">sum</span>(<span class="kw">abs</span>(z.calc -<span class="st"> </span>z.chart)) /<span class="st"> </span><span class="kw">n</span>(),
          <span class="dt">RMLSE =</span> <span class="kw">sqrt</span>(<span class="dv">1</span>/<span class="kw">n</span>()*<span class="kw">sum</span>((<span class="kw">log</span>(z.calc +<span class="dv">1</span>)-<span class="kw">log</span>(z.chart +<span class="dv">1</span>))^<span class="dv">2</span>))
          )

<span class="kw">ggplot</span>(smry_tpr_ppr, <span class="kw">aes</span>(Ppr, Tpr)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>smry_tpr_ppr, <span class="kw">aes</span>(<span class="dt">fill=</span>MAPE), <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">mid=</span><span class="st">&quot;yellow&quot;</span>, <span class="dt">na.value =</span> <span class="st">&quot;pink&quot;</span>,
                         <span class="dt">midpoint=</span><span class="fl">12.5</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">name=</span><span class="st">&quot;MAPE&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">vjust=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">11</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">coord_equal</span>() +
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Dranchuk-Purvis-Robinson&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;DPR&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<blockquote>
<p>The greatest errors are localized in two of the Tpr curves: 1.05 and barely at 1.1</p>
</blockquote>
</div>
<div id="plotting-the-tpr-and-ppr-values-that-show-more-error" class="section level2">
<h2>Plotting the <code>Tpr</code> and <code>Ppr</code> values that show more error</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)

sk_corr_all %&gt;%
<span class="st">    </span><span class="kw">filter</span>(Tpr %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1.05&quot;</span>, <span class="st">&quot;1.1&quot;</span>)) %&gt;%
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z.chart, <span class="dt">y=</span>z.calc, <span class="dt">group =</span> Tpr, <span class="dt">color =</span> Tpr)) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z.chart, <span class="dt">y =</span> z.chart), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) +
<span class="st">    </span><span class="kw">facet_grid</span>(. ~<span class="st"> </span>Tpr) +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-<span class="kw">abs</span>(dif), <span class="dt">ymax=</span>z.calc+<span class="kw">abs</span>(dif)), 
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="looking-numerically-at-the-errors" class="section level2">
<h2>Looking numerically at the errors</h2>
<p>Finally, the dataframe with the calculated errors between the <code>z</code> from the correlation and the <code>z</code> read from the chart:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.tibble</span>(smry_tpr_ppr)</code></pre></div>
<pre><code>Source: local data frame [112 x 9]
Groups: Tpr [?]

# A tibble: 112 x 9
     Tpr   Ppr         RMSE        MPE       MAPE          MSE
   &lt;chr&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
 1  1.05   0.5 0.0009756528  0.1176903  0.1176903 9.518984e-07
 2  1.05   1.5 0.0319670358 12.6351920 12.6351920 1.021891e-03
 3  1.05   2.5 0.0444731970 12.9659466 12.9659466 1.977865e-03
 4  1.05   3.5 0.0361451067  7.6741203  7.6741203 1.306469e-03
 5  1.05   4.5 0.0271306123  4.5368917  4.5368917 7.360701e-04
 6  1.05   5.5 0.0137256422  1.8879838  1.8879838 1.883933e-04
 7  1.05   6.5 0.0080944856  0.9567950  0.9567950 6.552070e-05
 8   1.1   0.5 0.0026367700  0.3087553  0.3087553 6.952556e-06
 9   1.1   1.5 0.0169389191  3.9762721  3.9762721 2.869270e-04
10   1.1   2.5 0.0190546763  4.8485181  4.8485181 3.630807e-04
# ... with 102 more rows, and 3 more variables: RSS &lt;dbl&gt;, MAE &lt;dbl&gt;,
#   RMLSE &lt;dbl&gt;</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
