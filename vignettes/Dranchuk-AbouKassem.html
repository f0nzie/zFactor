<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-03-25" />

<title>Dranchuk-AbouKassem correlation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Dranchuk-AbouKassem correlation</h1>
<h4 class="date">2019-03-25</h4>



<div id="the-dak-correlation" class="section level2">
<h2>The <code>DAK</code> correlation</h2>
<p>The work by P.M. Dranchuk and J.H. Abou-Kassem was looking to examine <code>z</code> outside the regions established by the Standing-Katz chart. They used as a basis the generalized Starling equation of state. They provided the code in FORTRAN. See <span class="citation">(Dranchuk and Abou-Kassem <a href="#ref-Dranchuk1975">1975</a>)</span></p>
</div>
<div id="get-z-at-selected-ppr-and-tpr" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<p>Use the the correlation to calculate <code>z</code> and from Standing-Katz chart obtain <code>z</code> a digitized point at the given <code>Tpr</code> and <code>Ppr</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># get a z value</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">ppr &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">tpr &lt;-<span class="st"> </span><span class="fl">2.0</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">z.calc &lt;-<span class="st"> </span><span class="kw">z.DranchukAbuKassem</span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co"># get a z value from the SK chart at the same Ppr and Tpr</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr, </a>
<a class="sourceLine" id="cb1-12" data-line-number="12">                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="kw">as.character</span>(ppr)]</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co"># calculate the APE</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">list</span>(<span class="dt">Ppr =</span> ppr,  <span class="dt">z.calc =</span>z.calc, <span class="dt">z.chart =</span> z.chart, <span class="dt">ape=</span>ape))</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>tpr</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">df</a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co"># HY = 0.9580002; # DAK = 0.9551087</span></a></code></pre></div>
<pre><code>  Ppr    z.calc z.chart        ape
2 1.5 0.9551087   0.956 0.09322868</code></pre>
</div>
<div id="get-z-at-selected-ppr-and-tpr1.1" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr=1.1</code></h2>
<p>From the Standing-Katz chart we read <code>z</code> at a digitized point:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">ppr &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">tpr &lt;-<span class="st"> </span><span class="fl">1.1</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">z.calc &lt;-<span class="st"> </span><span class="kw">z.DranchukAbuKassem</span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co"># From the Standing-Katz chart we obtain a digitized point:</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr, </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="kw">as.character</span>(ppr)]</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co"># calculate the APE (Average Percentage Error)</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">list</span>(<span class="dt">Ppr =</span> ppr,  <span class="dt">z.calc =</span>z.calc, <span class="dt">z.chart =</span> z.chart, <span class="dt">ape=</span>ape))</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>tpr</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">df</a></code></pre></div>
<pre><code>    Ppr    z.calc z.chart     ape
1.1 1.5 0.4463987   0.426 4.78842</code></pre>
<blockquote>
<p>At lower <code>Tpr</code> we can see that there is some difference between the values of z from the DAK calculation and the <code>z</code> value read from the Standing-Katz chart. See the <code>APE</code>.</p>
</blockquote>
</div>
<div id="get-values-of-z-for-combinations-of-ppr-and-tpr" class="section level2">
<h2>Get values of <code>z</code> for combinations of <code>Ppr</code> and <code>Tpr</code></h2>
<p>In this example we provide vectors instead of a single point. With the same <code>ppr</code> and <code>tpr</code> vectors that we use for the correlation, we do the same for the <code>Standing-Katz</code> chart. We want to compare both and find the <code>absolute percentage error</code> or <code>APE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># test DAK with 1st-derivative using the values from paper </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) </a>
<a class="sourceLine" id="cb5-3" data-line-number="3">tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.7</span>, <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co"># calculate using the correlation</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">z.calc &lt;-<span class="st"> </span><span class="kw">z.DranchukAbuKassem</span>(ppr, tpr)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co"># With the same ppr and tpr vector, we do the same for the Standing-Katz chart</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co"># calculate the APE</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw">cat</span>(<span class="st">&quot;z.correlation </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.calc)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> z.chart </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.chart)</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> APE </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(ape)</a></code></pre></div>
<pre><code>z.correlation 
           0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.05 0.8300683 0.2837318 0.3868282 0.5063005 0.6239783 0.7392097 0.8521762
1.1  0.8570452 0.4463987 0.4125200 0.5178068 0.6281858 0.7378206 0.8458725
1.7  0.9681353 0.9128087 0.8753784 0.8619509 0.8721085 0.9003962 0.9409634
2    0.9824731 0.9551087 0.9400752 0.9385273 0.9497137 0.9715388 1.0015560

 z.chart 
       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.05 0.829 0.253 0.343 0.471 0.598 0.727 0.846
1.10 0.854 0.426 0.393 0.500 0.615 0.729 0.841
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003

 APE 
            0.5         1.5         2.5       3.5       4.5       5.5
1.05 0.12887088 12.14694898 12.77790878 7.4947969 4.3441895 1.6794701
1.1  0.35658638  4.78841969  4.96692005 3.5613696 2.1440308 1.2099607
1.7  0.01397555  0.13033558  0.07096218 0.5776995 0.9384799 0.3786176
2    0.04818209  0.09322868  0.09827500 0.1629967 0.4988064 0.2620070
           6.5
1.05 0.7300441
1.1  0.5793746
1.7  0.1100436
2    0.1439679</code></pre>
<blockquote>
<p>You can see errors of 12.15% and 12.78% in the isotherm <code>Tpr=1.05</code> at <code>Ppr</code> 0.5 and 2.5. Other errors, greater than one, can also be found at the isotherm <code>Tpr=1.1</code>: 4.97%. Then, the rest of the <code>Tpr</code> curves are fine.</p>
</blockquote>
</div>
<div id="analyze-the-error-at-the-isotherms" class="section level2">
<h2>Analyze the error at the <code>isotherms</code></h2>
<p>Applying the function <code>summary</code> over the transpose of the matrix:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">sum_t_ape &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">t</span>(ape))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">sum_t_ape</a></code></pre></div>
<pre><code>      1.05              1.1              1.7                2          
 Min.   : 0.1289   Min.   :0.3566   Min.   :0.01398   Min.   :0.04818  
 1st Qu.: 1.2048   1st Qu.:0.8947   1st Qu.:0.09050   1st Qu.:0.09575  
 Median : 4.3442   Median :2.1440   Median :0.13034   Median :0.14397  
 Mean   : 5.6146   Mean   :2.5152   Mean   :0.31716   Mean   :0.18678  
 3rd Qu.: 9.8209   3rd Qu.:4.1749   3rd Qu.:0.47816   3rd Qu.:0.21250  
 Max.   :12.7779   Max.   :4.9669   Max.   :0.93848   Max.   :0.49881  </code></pre>
<blockquote>
<p>We can see that the errors in <code>z</code> are considerable with a Min. : 0.1289 % and Max. :12.7779 % for <code>Tpr=1.05</code>, and a Min. :0.3566 % and Max. :4.9669 % for <code>Tpr=1.10</code>. We will explore later a comparative <strong>tile</strong> chart where we confirm these early calculations.</p>
</blockquote>
</div>
<div id="analyze-the-error-for-greater-values-of-tpr" class="section level2">
<h2>Analyze the error for greater values of <code>Tpr</code></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># enter vectors for Tpr and Ppr</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.2</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>) </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>) </a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co"># get z values from the SK chart</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr2, <span class="dt">tpr_vector =</span> tpr2, <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co"># We do the same with the HY correlation:</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co"># calculate z values at lower values of Tpr</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">z.calc &lt;-<span class="st"> </span><span class="kw">z.DranchukAbuKassem</span>(<span class="dt">pres.pr =</span> ppr2, <span class="dt">temp.pr =</span> tpr2) </a>
<a class="sourceLine" id="cb9-12" data-line-number="12">ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co"># calculate the APE</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="kw">cat</span>(<span class="st">&quot;z.correlation </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.calc)</a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> z.chart </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.chart)</a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> APE </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(ape)</a></code></pre></div>
<pre><code>z.correlation 
          0.5       1.5       2.5       3.5       4.5       5.5
1.2 0.8950631 0.6532419 0.5180675 0.5631805 0.6501377 0.7453363
1.3 0.9203019 0.7543694 0.6377871 0.6339357 0.6898314 0.7663247
1.5 0.9509373 0.8593144 0.7929993 0.7710525 0.7896224 0.8331893
2   0.9824731 0.9551087 0.9400752 0.9385273 0.9497137 0.9715388
3   0.9984498 0.9995529 1.0061111 1.0176846 1.0336417 1.0532809

 z.chart 
       0.5   1.5   2.5   3.5   4.5   5.5
1.20 0.893 0.657 0.519 0.565 0.650 0.741
1.30 0.916 0.756 0.638 0.633 0.684 0.759
1.50 0.948 0.859 0.794 0.770 0.790 0.836
2.00 0.982 0.956 0.941 0.937 0.945 0.969
3.00 1.002 1.009 1.018 1.029 1.041 1.056

 APE 
           0.5        1.5        2.5       3.5        4.5       5.5
1.2 0.23103290 0.57200352 0.17966969 0.3220337 0.02117873 0.5851899
1.3 0.46964046 0.21568687 0.03336463 0.1478274 0.85254906 0.9650399
1.5 0.30984425 0.03659844 0.12603050 0.1366918 0.04779169 0.3362070
2   0.04818209 0.09322868 0.09827500 0.1629967 0.49880636 0.2620070
3   0.35430932 0.93627979 1.16787124 1.0996524 0.70685120 0.2574863</code></pre>
<blockquote>
<p>We observe that at <code>Tpr</code> above or equal to 1.2 the <code>DAK</code> correlation behaves very well.</p>
</blockquote>
</div>
<div id="analyze-the-error-at-the-isotherms-1" class="section level2">
<h2>Analyze the error at the <code>isotherms</code></h2>
<p>Applying the function <code>summary</code> over the transpose of the matrix to observe the error of the correlation at each isotherm.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">sum_t_ape &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">t</span>(ape))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">sum_t_ape</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"> <span class="co"># Hall-Yarborough</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"> <span class="co">#      1.2               1.3              1.5               2         </span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"> <span class="co"># Min.   :0.05224   Min.   :0.1105   Min.   :0.1021   Min.   :0.0809  </span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"> <span class="co"># 1st Qu.:0.09039   1st Qu.:0.2080   1st Qu.:0.1623   1st Qu.:0.1814  </span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"> <span class="co"># Median :0.28057   Median :0.3181   Median :0.1892   Median :0.1975  </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"> <span class="co"># Mean   :0.30122   Mean   :0.3899   Mean   :0.2597   Mean   :0.2284  </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"> <span class="co"># 3rd Qu.:0.51710   3rd Qu.:0.5355   3rd Qu.:0.3533   3rd Qu.:0.2627  </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"> <span class="co"># Max.   :0.57098   Max.   :0.8131   Max.   :0.5162   Max.   :0.4338  </span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"> <span class="co">#       3          </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"> <span class="co"># Min.   :0.09128  </span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"> <span class="co"># 1st Qu.:0.17466  </span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"> <span class="co"># Median :0.35252  </span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"> <span class="co"># Mean   :0.34820  </span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"> <span class="co"># 3rd Qu.:0.52184  </span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"> <span class="co"># Max.   :0.59923  </span></a></code></pre></div>
<pre><code>      1.2               1.3               1.5                2          
 Min.   :0.02118   Min.   :0.03336   Min.   :0.03660   Min.   :0.04818  
 1st Qu.:0.19251   1st Qu.:0.16479   1st Qu.:0.06735   1st Qu.:0.09449  
 Median :0.27653   Median :0.34266   Median :0.13136   Median :0.13064  
 Mean   :0.31852   Mean   :0.44735   Mean   :0.16553   Mean   :0.19392  
 3rd Qu.:0.50951   3rd Qu.:0.75682   3rd Qu.:0.26656   3rd Qu.:0.23725  
 Max.   :0.58519   Max.   :0.96504   Max.   :0.33621   Max.   :0.49881  
       3         
 Min.   :0.2575  
 1st Qu.:0.4424  
 Median :0.8216  
 Mean   :0.7537  
 3rd Qu.:1.0588  
 Max.   :1.1679  </code></pre>
<p>We can see that the errors in <code>z</code> with <code>DAK</code> are far lower than <code>Hall-Yarborough</code> with a Min. :0.02118 % and Max. :0.58519 % for <code>Tpr=1.2</code>, and a Min. :0.03336 % and Max. :0.96504 % for <code>Tpr=1.3</code>.</p>
</div>
<div id="prepare-to-plot-sk-vs-dak-correlation" class="section level2">
<h2>Prepare to plot SK vs DAK correlation</h2>
<p>The error bars represent the difference between the calculated values by the <code>Dranchuk-AbouKassem</code> corrrelation and teh values of <code>z</code> read from the Standing-Katz chart.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>) </a>
<a class="sourceLine" id="cb13-6" data-line-number="6">ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>) </a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">sk_dak_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr2, tpr2, <span class="dt">correlation =</span> <span class="st">&quot;DAK&quot;</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw">as.tibble</span>(sk_dak_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_dak_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc<span class="op">-</span>dif, <span class="dt">ymax=</span>z.calc<span class="op">+</span>dif), <span class="dt">width=</span>.<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="kw">print</span>(p)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code># A tibble: 52 x 5
   Tpr     Ppr z.chart z.calc       dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
 1 1.05    0.5   0.829  0.830 -0.00107 
 2 1.1     0.5   0.854  0.857 -0.00305 
 3 1.2     0.5   0.893  0.895 -0.00206 
 4 1.3     0.5   0.916  0.920 -0.00430 
 5 1.05    1     0.589  0.587  0.00232 
 6 1.1     1     0.669  0.677 -0.00837 
 7 1.2     1     0.779  0.778  0.000578
 8 1.3     1     0.835  0.837 -0.00221 
 9 1.05    1.5   0.253  0.284 -0.0307  
10 1.1     1.5   0.426  0.446 -0.0204  
# ... with 42 more rows</code></pre>
<p>We observe that with Dranchuk-AbouKassem there are still errors or differences between the <code>z</code> values in the Standing-Katz chart and the values obtained from the correlation but they are not as bad as in the HY correlation.</p>
</div>
<div id="analysis-at-the-lowest-tpr" class="section level2">
<h2>Analysis at the lowest <code>Tpr</code></h2>
<p>This is the isotherm where we see the greatest error.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">sk_dak_<span class="dv">3</span> &lt;-<span class="st"> </span>sk_dak_<span class="dv">2</span>[sk_dak_<span class="dv">2</span><span class="op">$</span>Tpr<span class="op">==</span><span class="fl">1.05</span>,]</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">sk_dak_<span class="dv">3</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_dak_<span class="dv">3</span>, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc<span class="op">-</span>dif, <span class="dt">ymax=</span>z.calc<span class="op">+</span>dif), <span class="dt">width=</span>.<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="kw">print</span>(p)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>    Tpr Ppr z.chart    z.calc          dif
1  1.05 0.5   0.829 0.8300683 -0.001068340
5  1.05 1.0   0.589 0.5866751  0.002324861
9  1.05 1.5   0.253 0.2837318 -0.030731781
13 1.05 2.0   0.280 0.3284040 -0.048404016
17 1.05 2.5   0.343 0.3868282 -0.043828227
21 1.05 3.0   0.407 0.4466387 -0.039638654
25 1.05 3.5   0.471 0.5063005 -0.035300493
29 1.05 4.0   0.534 0.5654448 -0.031444815
33 1.05 4.5   0.598 0.6239783 -0.025978253
37 1.05 5.0   0.663 0.6818928 -0.018892813
41 1.05 5.5   0.727 0.7392097 -0.012209748
45 1.05 6.0   0.786 0.7959599 -0.009959903
49 1.05 6.5   0.846 0.8521762 -0.006176173</code></pre>
</div>
<div id="analyzing-performance-of-the-dak-correlation-for-all-the-tpr-curves" class="section level2">
<h2>Analyzing performance of the <code>DAK</code> correlation for all the <code>Tpr</code> curves</h2>
<p>In this last example, we compare the values of <code>z</code> at all the isotherms. We use the function <code>getCurvesDigitized</code> to obtain all the isotherms or <code>Tpr</code> curves in the Standing-Katz chart that have been digitized. The next function <code>createTidyFromMatrix</code> calculate <code>z</code> using the correlation and prepares a tidy dataset ready to plot.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co"># get all `lp` Tpr curves</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">tpr_all &lt;-<span class="st"> </span><span class="kw">getStandingKatzTpr</span>(<span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) </a>
<a class="sourceLine" id="cb17-7" data-line-number="7">sk_corr_all &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr, tpr_all, <span class="dt">correlation =</span> <span class="st">&quot;DAK&quot;</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="kw">as.tibble</span>(sk_corr_all)</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"></a>
<a class="sourceLine" id="cb17-10" data-line-number="10">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_all, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc<span class="op">-</span>dif, <span class="dt">ymax=</span>z.calc<span class="op">+</span>dif), <span class="dt">width=</span>.<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb17-14" data-line-number="14">                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="kw">print</span>(p)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code># A tibble: 112 x 5
   Tpr     Ppr z.chart z.calc         dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;
 1 1.05    0.5   0.829  0.830 -0.00107   
 2 1.1     0.5   0.854  0.857 -0.00305   
 3 1.2     0.5   0.893  0.895 -0.00206   
 4 1.3     0.5   0.916  0.920 -0.00430   
 5 1.4     0.5   0.936  0.938 -0.00201   
 6 1.5     0.5   0.948  0.951 -0.00294   
 7 1.6     0.5   0.959  0.961 -0.00165   
 8 1.7     0.5   0.968  0.968 -0.000135  
 9 1.8     0.5   0.974  0.974 -0.00000593
10 1.9     0.5   0.978  0.979 -0.000688  
# ... with 102 more rows</code></pre>
<blockquote>
<p>The greatest errors are localized in two of the Tpr curves: at 1.05 and 1.1.</p>
</blockquote>
</div>
<div id="range-of-applicability-of-the-correlation" class="section level2">
<h2>Range of applicability of the correlation</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># MSE: Mean Squared Error</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co"># RMSE: Root Mean Squared Error</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co"># RSS: residual sum of square</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co"># ARE:  Average Relative Error, %</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co"># AARE: Average Absolute Relative Error, %</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">grouped &lt;-<span class="st"> </span><span class="kw">group_by</span>(sk_corr_all, Tpr, Ppr)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"></a>
<a class="sourceLine" id="cb19-9" data-line-number="9">smry_tpr_ppr &lt;-<span class="st"> </span><span class="kw">summarise</span>(grouped, </a>
<a class="sourceLine" id="cb19-10" data-line-number="10">          <span class="dt">RMSE=</span> <span class="kw">sqrt</span>(<span class="kw">mean</span>((z.chart<span class="op">-</span>z.calc)<span class="op">^</span><span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb19-11" data-line-number="11">          <span class="dt">MPE =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb19-12" data-line-number="12">          <span class="dt">MAPE =</span> <span class="kw">sum</span>(<span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb19-13" data-line-number="13">          <span class="dt">MSE =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart)<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb19-14" data-line-number="14">          <span class="dt">RSS =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart)<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb19-15" data-line-number="15">          <span class="dt">MAE =</span> <span class="kw">sum</span>(<span class="kw">abs</span>(z.calc <span class="op">-</span><span class="st"> </span>z.chart)) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb19-16" data-line-number="16">          <span class="dt">RMLSE =</span> <span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">n</span>()<span class="op">*</span><span class="kw">sum</span>((<span class="kw">log</span>(z.calc <span class="op">+</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">log</span>(z.chart <span class="op">+</span><span class="dv">1</span>))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb19-17" data-line-number="17">          )</a>
<a class="sourceLine" id="cb19-18" data-line-number="18"></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="kw">ggplot</span>(smry_tpr_ppr, <span class="kw">aes</span>(Ppr, Tpr)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>smry_tpr_ppr, <span class="kw">aes</span>(<span class="dt">fill=</span>MAPE), <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="st">    </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">mid=</span><span class="st">&quot;yellow&quot;</span>, <span class="dt">na.value =</span> <span class="st">&quot;pink&quot;</span>,</a>
<a class="sourceLine" id="cb19-22" data-line-number="22">                         <span class="dt">midpoint=</span><span class="fl">12.5</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">name=</span><span class="st">&quot;MAPE&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-23" data-line-number="23"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">vjust=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">11</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-24" data-line-number="24"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-25" data-line-number="25"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Dranchuk-AbouKassem&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;DAK&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<blockquote>
<p>The greatest errors are localized in two of the Tpr curves: 1.05 and barely at 1.1. But the errors are smaller than that we saw in the <code>HY</code> plot.</p>
</blockquote>
</div>
<div id="plotting-the-tpr-and-ppr-values-that-show-more-error" class="section level2">
<h2>Plotting the <code>Tpr</code> and <code>Ppr</code> values that show more error</h2>
<p>The <code>MAPE</code> (mean average percentage error) gradient bar indicates that the more red the square is, the more error there is.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">sk_corr_all <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">    </span><span class="kw">filter</span>(Tpr <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1.05&quot;</span>, <span class="st">&quot;1.1&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z.chart, <span class="dt">y=</span>z.calc, <span class="dt">group =</span> Tpr, <span class="dt">color =</span> Tpr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z.chart, <span class="dt">y =</span> z.chart), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="st">    </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Tpr) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc<span class="op">-</span><span class="kw">abs</span>(dif), <span class="dt">ymax=</span>z.calc<span class="op">+</span><span class="kw">abs</span>(dif)), </a>
<a class="sourceLine" id="cb20-10" data-line-number="10">                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="looking-numerically-at-the-errors" class="section level2">
<h2>Looking numerically at the errors</h2>
<p>Finally, the dataframe with the calculated errors between the <code>z</code> from the correlation and the <code>z</code> read from the chart:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">as_tibble</span>(smry_tpr_ppr)</a></code></pre></div>
<pre><code># A tibble: 112 x 9
   Tpr     Ppr    RMSE    MPE   MAPE        MSE        RSS     MAE    RMLSE
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1 1.05    0.5 0.00107  0.129  0.129 0.00000114 0.00000114 0.00107 0.000584
 2 1.05    1.5 0.0307  12.1   12.1   0.000944   0.000944   0.0307  0.0242  
 3 1.05    2.5 0.0438  12.8   12.8   0.00192    0.00192    0.0438  0.0321  
 4 1.05    3.5 0.0353   7.49   7.49  0.00125    0.00125    0.0353  0.0237  
 5 1.05    4.5 0.0260   4.34   4.34  0.000675   0.000675   0.0260  0.0161  
 6 1.05    5.5 0.0122   1.68   1.68  0.000149   0.000149   0.0122  0.00705 
 7 1.05    6.5 0.00618  0.730  0.730 0.0000381  0.0000381  0.00618 0.00334 
 8 1.1     0.5 0.00305  0.357  0.357 0.00000927 0.00000927 0.00305 0.00164 
 9 1.1     1.5 0.0204   4.79   4.79  0.000416   0.000416   0.0204  0.0142  
10 1.1     2.5 0.0195   4.97   4.97  0.000381   0.000381   0.0195  0.0139  
# ... with 102 more rows</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Dranchuk1975">
<p>Dranchuk, P. M., and H. Abou-Kassem. 1975. “Calculation of Z Factors for Natural Gases Using Equations of State.” <em>Journal of Canadian Petroleum Technology</em>, July. Petroleum Society of Canada. <a href="https://doi.org/10.2118/75-03-03" class="uri">https://doi.org/10.2118/75-03-03</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
