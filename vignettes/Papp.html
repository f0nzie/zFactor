<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-03-25" />

<title>Papp correlation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Papp correlation</h1>
<h4 class="date">2019-03-25</h4>



<div id="papp-correlation" class="section level2">
<h2>Papp correlation</h2>
<p><span class="citation">(Hall and Yarborough <a href="#ref-Hall1973">1973</a>)</span> This is an explicit correlation by <em>I. Papp</em> <span class="citation">(Papp <a href="#ref-Papp1979">1979</a>)</span> mentioned in the comparative analysis paper by Gabor Takacs <span class="citation">(Takacs <a href="#ref-Takacs1989">1989</a>)</span>. The original paper is not available in English but Prof.Â Takacs describe the equation in his paper of 1989.</p>
</div>
<div id="get-z-at-selected-ppr-and-tpr" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<p>Use the the correlation to calculate <code>z</code> and from Standing-Katz chart obtain <code>z</code> a digitized point at the given <code>Tpr</code> and <code>Ppr</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># get a z value</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">ppr &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">tpr &lt;-<span class="st"> </span><span class="fl">2.0</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">z.calc &lt;-<span class="st"> </span><span class="kw">z.Papp</span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co"># get a z value from the SK chart at the same Ppr and Tpr</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr, </a>
<a class="sourceLine" id="cb1-10" data-line-number="10">                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="kw">as.character</span>(ppr)]</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># calculate the APE</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">list</span>(<span class="dt">Ppr =</span> ppr,  <span class="dt">z.calc =</span>z.calc, <span class="dt">z.chart =</span> z.chart, <span class="dt">ape=</span>ape))</a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>tpr</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">df</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co"># HY = 0.9580002; # DAK = 0.9551087</span></a></code></pre></div>
<pre><code>  Ppr   z.calc z.chart       ape
2 1.5 0.962332   0.956 0.6623461</code></pre>
</div>
<div id="get-z-at-selected-ppr-and-tpr1.1" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr=1.1</code></h2>
<p>From the Standing-Katz chart we read <code>z</code> at a digitized point:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">ppr &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">tpr &lt;-<span class="st"> </span><span class="fl">1.1</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">z.calc &lt;-<span class="st"> </span><span class="kw">z.Papp</span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># From the Standing-Katz chart we obtain a digitized point:</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr, </a>
<a class="sourceLine" id="cb3-9" data-line-number="9">                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="kw">as.character</span>(ppr)]</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co"># calculate the APE (Average Percentage Error)</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">list</span>(<span class="dt">Ppr =</span> ppr,  <span class="dt">z.calc =</span>z.calc, <span class="dt">z.chart =</span> z.chart, <span class="dt">ape=</span>ape))</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>tpr</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">df</a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co"># HY = 0.4732393  APE = 11.08903</span></a></code></pre></div>
<pre><code>    Ppr    z.calc z.chart      ape
1.1 1.5 0.5361425   0.426 25.85506</code></pre>
</div>
<div id="get-values-of-z-for-combinations-of-ppr-and-tpr" class="section level2">
<h2>Get values of <code>z</code> for combinations of <code>Ppr</code> and <code>Tpr</code></h2>
<p>In this example we provide vectors instead of a single point. With the same <code>ppr</code> and <code>tpr</code> vectors that we use for the correlation, we do the same for the <code>Standing-Katz</code> chart. We want to compare both and find the <code>absolute percentage error</code> or <code>APE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># test with vector extracted from paper</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) </a>
<a class="sourceLine" id="cb5-3" data-line-number="3">tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.7</span>, <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co"># calculate using the correlation</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">z.calc &lt;-<span class="st"> </span><span class="kw">z.Papp</span>(ppr, tpr)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co"># With the same ppr and tpr vector, we do the same for the Standing-Katz chart</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co"># calculate the APE</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw">cat</span>(<span class="st">&quot;z.correlation </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.calc)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> z.chart </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.chart)</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> APE </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(ape)</a></code></pre></div>
<pre><code>z.correlation 
           0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.05 0.8243607 0.4692711 0.3958632 0.4788553 0.5906236 0.7046099 0.8186716
1.1  0.8517120 0.5361425 0.4430332 0.5056550 0.6077642 0.7145435 0.8215955
1.7  0.9736623 0.9138939 0.8665932 0.8471834 0.8578133 0.8919610 0.9406180
2    0.9877275 0.9623320 0.9432543 0.9366532 0.9450048 0.9675653 1.0015334

 z.chart 
       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.05 0.829 0.253 0.343 0.471 0.598 0.727 0.846
1.10 0.854 0.426 0.393 0.500 0.615 0.729 0.841
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003

 APE 
           0.5         1.5        2.5        3.5         4.5       5.5
1.05 0.5596238 85.48266650 15.4120172 1.66779568 1.233507926 3.0797870
1.1  0.2679163 25.85505860 12.7311015 1.13099950 1.176554761 1.9830566
1.7  0.5849433  0.01160694  1.0738373 1.14546413 0.716057626 0.5617635
2    0.5832436  0.66234608  0.2395608 0.03701248 0.000507908 0.1480622
           6.5
1.05 3.2303092
1.1  2.3073158
1.7  0.1467143
2    0.1462221</code></pre>
</div>
<div id="analyze-the-error-at-the-isotherms" class="section level2">
<h2>Analyze the error at the <code>isotherms</code></h2>
<p>Applying the function <code>summary</code> over the transpose of the matrix:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">sum_t_ape &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">t</span>(ape))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">sum_t_ape</a></code></pre></div>
<pre><code>      1.05              1.1               1.7                2            
 Min.   : 0.5596   Min.   : 0.2679   Min.   :0.01161   Min.   :0.0005079  
 1st Qu.: 1.4506   1st Qu.: 1.1538   1st Qu.:0.35424   1st Qu.:0.0916173  
 Median : 3.0798   Median : 1.9831   Median :0.58494   Median :0.1480622  
 Mean   :15.8094   Mean   : 6.4931   Mean   :0.60577   Mean   :0.2595650  
 3rd Qu.: 9.3212   3rd Qu.: 7.5192   3rd Qu.:0.89495   3rd Qu.:0.4114022  
 Max.   :85.4827   Max.   :25.8551   Max.   :1.14546   Max.   :0.6623461  </code></pre>
</div>
<div id="analyze-the-error-for-greater-values-of-tpr" class="section level2">
<h2>Analyze the error for greater values of <code>Tpr</code></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># enter vectors for Tpr and Ppr</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.2</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>) </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>) </a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co"># get z values from the SK chart</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">z.chart &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr2, <span class="dt">tpr_vector =</span> tpr2, <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co"># We do the same with the HY correlation:</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co"># calculate z values at lower values of Tpr</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">z.calc &lt;-<span class="st"> </span><span class="kw">z.Papp</span>(<span class="dt">pres.pr =</span> ppr2, <span class="dt">temp.pr =</span> tpr2) </a>
<a class="sourceLine" id="cb9-12" data-line-number="12">ape &lt;-<span class="st"> </span><span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co"># calculate the APE</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="kw">cat</span>(<span class="st">&quot;z.correlation </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.calc)</a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> z.chart </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(z.chart)</a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> APE </span><span class="ch">\n</span><span class="st">&quot;</span>); <span class="kw">print</span>(ape)</a></code></pre></div>
<pre><code>z.correlation 
          0.5       1.5       2.5       3.5       4.5       5.5
1.2 0.8926577 0.6489440 0.5388870 0.5640639 0.6449346 0.7382795
1.3 0.9208943 0.7357072 0.6290383 0.6271826 0.6858996 0.7656800
1.5 0.9552137 0.8499334 0.7728520 0.7501411 0.7749505 0.8279008
2   0.9877275 0.9623320 0.9432543 0.9366532 0.9450048 0.9675653
3   0.9995561 1.0001483 1.0032952 1.0095589 1.0193297 1.0328185

 z.chart 
       0.5   1.5   2.5   3.5   4.5   5.5
1.20 0.893 0.657 0.519 0.565 0.650 0.741
1.30 0.916 0.756 0.638 0.633 0.684 0.759
1.50 0.948 0.859 0.794 0.770 0.790 0.836
2.00 0.982 0.956 0.941 0.937 0.945 0.969
3.00 1.002 1.009 1.018 1.029 1.041 1.056

 APE 
           0.5       1.5       2.5        3.5         4.5       5.5
1.2 0.03832749 1.2261856 3.8317839 0.16567267 0.779298982 0.3671385
1.3 0.53431458 2.6842320 1.4046605 0.91901585 0.277717125 0.8801037
1.5 0.76093659 1.0554821 2.6634712 2.57908019 1.905004145 0.9688092
2   0.58324362 0.6623461 0.2395608 0.03701248 0.000507908 0.1480622
3   0.24389752 0.8772760 1.4444808 1.88931540 2.081676730 2.1952223</code></pre>
</div>
<div id="analyze-the-error-at-the-isotherms-1" class="section level2">
<h2>Analyze the error at the <code>isotherms</code></h2>
<p>Applying the function <code>summary</code> over the transpose of the matrix to observe the error of the correlation at each isotherm.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">sum_t_ape &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">t</span>(ape))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">sum_t_ape</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"> <span class="co"># Hall-Yarborough</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"> <span class="co">#      1.2               1.3              1.5               2         </span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"> <span class="co"># Min.   :0.05224   Min.   :0.1105   Min.   :0.1021   Min.   :0.0809  </span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"> <span class="co"># 1st Qu.:0.09039   1st Qu.:0.2080   1st Qu.:0.1623   1st Qu.:0.1814  </span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"> <span class="co"># Median :0.28057   Median :0.3181   Median :0.1892   Median :0.1975  </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"> <span class="co"># Mean   :0.30122   Mean   :0.3899   Mean   :0.2597   Mean   :0.2284  </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"> <span class="co"># 3rd Qu.:0.51710   3rd Qu.:0.5355   3rd Qu.:0.3533   3rd Qu.:0.2627  </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"> <span class="co"># Max.   :0.57098   Max.   :0.8131   Max.   :0.5162   Max.   :0.4338  </span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"> <span class="co">#       3          </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"> <span class="co"># Min.   :0.09128  </span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"> <span class="co"># 1st Qu.:0.17466  </span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"> <span class="co"># Median :0.35252  </span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"> <span class="co"># Mean   :0.34820  </span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"> <span class="co"># 3rd Qu.:0.52184  </span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"> <span class="co"># Max.   :0.59923  </span></a></code></pre></div>
<pre><code>      1.2               1.3              1.5               2            
 Min.   :0.03833   Min.   :0.2777   Min.   :0.7609   Min.   :0.0005079  
 1st Qu.:0.21604   1st Qu.:0.6208   1st Qu.:0.9905   1st Qu.:0.0647749  
 Median :0.57322   Median :0.8996   Median :1.4802   Median :0.1938115  
 Mean   :1.06807   Mean   :1.1167   Mean   :1.6555   Mean   :0.2784555  
 3rd Qu.:1.11446   3rd Qu.:1.2832   3rd Qu.:2.4106   3rd Qu.:0.4973229  
 Max.   :3.83178   Max.   :2.6842   Max.   :2.6635   Max.   :0.6623461  
       3         
 Min.   :0.2439  
 1st Qu.:1.0191  
 Median :1.6669  
 Mean   :1.4553  
 3rd Qu.:2.0336  
 Max.   :2.1952  </code></pre>
</div>
<div id="prepare-to-plot-sk-vs-pp-correlation" class="section level2">
<h2>Prepare to plot SK vs PP correlation</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>) </a>
<a class="sourceLine" id="cb13-6" data-line-number="6">ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>) </a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">sk_dak_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr2, tpr2, <span class="dt">correlation =</span> <span class="st">&quot;PP&quot;</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw">as.tibble</span>(sk_dak_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_dak_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc<span class="op">-</span>dif, <span class="dt">ymax=</span>z.calc<span class="op">+</span>dif), <span class="dt">width=</span>.<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="kw">print</span>(p)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAOpAAZrYAv8QzMzM6AAA6ADo6AGY6OpA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmtv9uTU1uTW5uTY5ubo5ubqtuq+R8rgCOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQkDqQkGaQtpCQ2/+rbk2rbm6rjk2r5OSr5P+2ZgC2///HfP/Ijk3I///bkDrb///kq27k///r6+vy8vL4dm3/tmb/yI7/25D/5Kv//7b//8j//9v//+T////gMrK1AAAACXBIWXMAAA7DAAAOwwHHb6hkAAANbUlEQVR4nO3dC3vUuBUG4FmIGyhZttnCtmDaLuleoFuSYUPWVZiE4P//o2rdjyzZR/ZIvsycbx/IMOsk9htdbFlWNjWlN5u5d2DpISAkBISEgJAQEBICQjIcqPITei/bu8EdyBcCQkJASAgICQEhISAkBISEgJAQEBICQjIaaLvdElAwxscKERAMASEhICSVEcpNsW6ghoiAgiEgJHa3qA0KhoDiUhTFNuWOLDVjS1DBs+35oR5vCSIgJABIt0IEBFMZoYqAQjF7RUDhQCAlREAwBITE7lZBQKE4QFKIgGAICAkBIQH7pYUICEbtU1mWBBSM8SnLmYHsqG8GGJ29gbjQPEDgvkEGGJ29gHQdIyCYygjJVroRmgmIsSUDNURzA23ZgtsgCaTq2CxA26pkxSqAqu08QEXBimIdQOAm62RA22rhQIyxOYG21cKBGDNCzjyGiYDE9yuW3AbNCyS+XdkAlQQUelOWn7Jk5XKBuJDp56dug7biGy8cqCESe1dMDKSLa9F8/+a/RQOZjr6uJqtiuj4337aUlXw+oC9vzr77Q7y6e3n2/PdFAQmfipkN5wD6+v5tffMXIfWPD/WNsvKA+L5ODsR/KrMDffnn7/Xd33jBuXv1h/hXD1BIKFsbpAtQOS+QYGnKDixBf2piNmB1yT8U4h9TzRXaqm9ZMrEH+dMN9Pk7DQRaoxoO2ptGyJy7ZS9BYnROVbBq5ipmS9DdDx/qz8+9Kmbr2GRAWzWrRPkspQ0CZWl2IDkvqSpbG84B9PX9a9WLRZUgXyg9EC9AjF/C2+Z5RiDV8vBC9Pns7FtdgGYEEieIZQPU9lnomTRvI6WQvv0zAZAY41gLkClChd3/jED6Esz3ISDgY69Q1wQUFEoJpAcM4CDQaoBUz5sTyF7DE1AfED8BWhmQuL1ahOtYFiC2qjbIFqEqP5AcetJj4RFADxcbmZO5gXQ3ZsdDEwOpBpr/VYZ8ukvQ7sm7fXTq5EB5nkO0QMEKdvRAwKcCw4jxQLsnv2w2jz/Vu6c/bx5dTQskW+nKCqUHEv17oSpYNQro9NHVw8VJ83F4c5QCSI1hiYNJ3wYpHznIMRbohXgpPk4KpOqYAcqw3IC8wlBAzjDiACD+9/35izEtUiIgJZQeSLU/AkgWIAIKAFW2AAU3xYBEFXt6NQsQFzJAadsgqy1mjKoOfhSQaqRnBAL9WCogWxwLxlQLPRKId/Mn486K0gMlq2IGqJDfh3VviuzyPqeL+y7RxSYCKnUBWj+QqWQpgJQPH+MoezZFdnleoEaorrQQP6ZEQPoRB3UJtg/QPkkMpA9tfyD9FJG6xCCggI8FYg0Q69p0LUCeUJITRflF4TDZyoBEK50eSH8F+TXLVQG1wmo5TUhPFBLZd7aQ/Pzm+kL+k4/UTzEXKJQEJagq1XutIjS+BMEr1EqcQ7OuTXtL0P+CWQLQHk+y2gswDVRWBOTfInSAnHHWdQOZH/XYJ1nhgIn1WTMQ78b0SVxhj2Q7cv49LEHyXVGAVg0kH4BuATnD9wOBtI94t2yPsR43kP0cOYPf91k1kJjeZIRGVDHwGYUaRswJtHsqb5Ldn/O7ZvX1ZuPfNkvaBkGgMU+ROT6i8fd9RgE15+EBoFvF8XDxor4+qevL0E2hFEBVnQao5SPhUwCJKxUP6PKbX2UJuv/rFS9MD/8OjRolWPSfWaCq2AOo7cMv4UNTXQYAMS+hKrb786f6/vt3TUXbbLxClA2oGgoEN/YGgUYC9ZYgA3T7WADxcUe/FOUDcmcy9AO1MPU1fCqgjjaoVYLEW147lAbIPBpgn9SWOnEPKLSqo/4Socl2OXox1QblA2JMA4Fn/VU3HzW93L++UF83OFkqOdDDxTPei/Ga9vBT+m5eXEoGgEbdIgQTHsUgUH4g/seeB33jdWQOEKfkt2iHAVWgBJUeUMT0cnjdBoDyl6CYOECXJ0KpXygIZIRAG+SfHYePzxkaAaNkVdBnTqD7c9FC3fbPUusFqnwgUUC6j2/rjj46PsFKunagym+D+ua+tm8R6c9eJFB9zWnuz5/1fsY4oMAd+9BdWMdneUDN5VuTfp8OIC3E7EEiQKF3Da68SF0eUExCQAwH2rYrUwAI+CQBSpE0J4q2ozfLUrUrk2qOFcrWQataN6/1RfyiSpC4lpUZ2EjHABkoAOM13a0KtjCg6HQAKSFmjzTiqss5aq8AHQqQOqHbF0hfYIBRssUB7U7HVDGnG0OAukeqVfmRA9wLBWouxR4uXqjTRbhix9f3wefmO4Hk0Q64cWguwCRQ30SOuc+kL5+Jy/4arh9Uf3wrlqfoB5JCo4CKFlDftnMD8XERWcXs2h127aBYIH1XaxwQ69t27qv5RudaliCw+sur31QVc9YPsmFiJZ9SvhQpAlt1RwCpL8WvMFIFA9LDiPBVO9540KUeNLJrvty9fCu4ZEIlqDKNkP7pF0NLkCpAziBQshLUFMsA0K3pjm67O6ao9YNehZfHaQEJIQtkR86w4wOYeYBEw+YBmfti4NUQINAG/dgPxAJAlX0KETs+0F6VVVqg0sv+VcwMKNr1g3gv1lvF6srUseFAoMcTXwAMI+YtQSOA3CFXu35Q8yqwjmI/0IAqBoGcUdbMbdBgoLEjihrIXkRJoKBQ+/PBWbcLnBIoUS+WFAic2/QdH7zy96YqLA1o7JDrHkBwcM0rQJMASZpIoJFDrmKf2WAguEEd8lnemXRUeoCc+U4YUOEDxUwmOxwgXn0CQl1AgQK0VKBRjXQYKCAUBJJX8FGTyRYAhKRrn1kISP1VtLat5LUI8ImebbduILiCnzp8y+Qcn1O0nGHEhEApkg8ITL/3gFrNtzOMmBAodQm6PxcXGePaIA/IzjrzgLyWKVyAFggkhkVSAzkdflEErmL5M4uxM11mBfr+3eXmxVgg2UozO63QASq8l9BnLUB8THpz0n3ajQI5qxy6QCA+UHiq1CKB+L2x8SWoB8h76fpETyabHah+uEgNVLXaoLbPaoDi0r3PrKMNCp0HOVsdEVA1CmiuNki3tvyWe9fyb8mBqkAV6wFS94ribxGNAmoqdgBI3+zhjyF0LhCTD4h5Vx2B49P30vICia7BAzI3e275+XHwYbHEQOrxZDufEz++zEDtEwzBZP8/OKHRD7MsDMjcjJ2jBEEgfsNrMiA4G6/v+NQ0ju7ZiLnbIAvUMw4/H5Ce6DIFENqLdS9hmgPImUuFAfXMRpwKqHeJ172Xx3Ei58Go9XKQaSwCKO+vwIoBav5ci4mHU/RicJpHVAnqn655cGfSBsidKhTe1kU8ciD47OlxA5nT59ZdHHCBVoZ8CKj9Uo1x9FMcMlDrRnIbyBvjyAOUIrMA6SGO3ECLLEFWqBOo1JseHxA4aBQIn4142EDhW2SVfdLAGUU8TqDA6Kt9FCNiLtkBAsE2KHiD4+iBqligmMl2hwmkDz0IVFZhn2MEEm2Qe2FR2nOgKIrJBsxuN2MeZhkLZI6eGRR5dggeNJgaaLvdBoD0bR/udN21oktuIFHXGC9M6s3gZMTMQOJRYg/Iecanc8ZGBiB9/IYBNkcsNBcxG9DWS7CKNZmyBC0IqLcEAaDdqb/0VEYgJdAFFD1NIXcbNP2Nww4geFI9ZJrCZL0YzyS3nl0b1n63GjjRZSogtdAkAQWBRB8fWv4uD1AJGujlA8UkTwnqBYqmOGQgeMLovBtel4yA7JsEZF54QKLeHRCQXR5HLgWzL5D8a0qgFOkGAsvj1PXN2VAg55TQtNkdbfQqgezSFHV99/d/DS5BsMMCLdLhlCCwpMnX//xXVrGO5XFAzHQfBha6SbrmzcTpBrLL49Q3r0e0Qa2MKCurKUHNq+FAoLk5UCDbBt2c8bweCAQKU3mQQGB5nDHdfFeHdjhAYHmcfYHgywMC6ggBISEgJASEhICQxAKVBNQPRCWIgMIhICQEhISAkBAQEgJCQkBIhgONnTJ+NEBjKQiIgAiIgPwQEBICQkJASAgICQEhISAkBISEgPYKC75ccagEISEgJASEhICQEBASAkKSD2j/KeMHDrQ/BQEREAERkB8CQkJASAgISe8+J70Lf4hAE7xLQAREQAREQD0hICQEhISAkBAQEgJKFWSNhrHbDvmyCUJASAgICQEhyQh0GCEgJASEhICQEBCSXEB3L8/sunBowOIy2IZn334YuUvjkgmIL11190P0odzEYn58K5YOmzCZgD7zlZk+xhYhuMheb/iqWBMnYxukVojDYxbZQ3P36rcDqWK1XOIrLs4ie725e/lWLD43YbIBfXkT6+MusodtGl8w0yRfLxbdh7mL7PXmy4+HAjTAhye6m/94KFVMlopopGigL2/Onk/bkdGZNBICQkJASAgICQEhISAkUwM9XGx4On9TzOIyPdAz/uG683cKLi0zAd2fd/y2qsVlPqDdk182m8ef6t3Tn7t/R+X8mQno8tHV7vTR1cPFSb077fr1govITI10U2R2p00t2z15Jz4uNzOVoFrYqKq26B6NgJDMCCSq2NMrAnICgVQjTUAwsIo13fxJTUBdWTiMDgEhISAkNNyBhICQEBASAkJCQEgICAkBIfk/pqaHhK0PFiQAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<pre><code># A tibble: 52 x 5
   Tpr     Ppr z.chart z.calc       dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
 1 1.05    0.5   0.829  0.824  0.00464 
 2 1.1     0.5   0.854  0.852  0.00229 
 3 1.2     0.5   0.893  0.893  0.000342
 4 1.3     0.5   0.916  0.921 -0.00489 
 5 1.05    1     0.589  0.620 -0.0309  
 6 1.1     1     0.669  0.676 -0.00680 
 7 1.2     1     0.779  0.763  0.0160  
 8 1.3     1     0.835  0.825  0.00981 
 9 1.05    1.5   0.253  0.469 -0.216   
10 1.1     1.5   0.426  0.536 -0.110   
# ... with 42 more rows</code></pre>
</div>
<div id="analysis-at-the-lowest-tpr" class="section level2">
<h2>Analysis at the lowest <code>Tpr</code></h2>
<p>This is the isotherm where we see the greatest error.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">library</span>(zFactor)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">sk_dak_<span class="dv">3</span> &lt;-<span class="st"> </span>sk_dak_<span class="dv">2</span>[sk_dak_<span class="dv">2</span><span class="op">$</span>Tpr<span class="op">==</span><span class="fl">1.05</span>,]</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">sk_dak_<span class="dv">3</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_dak_<span class="dv">3</span>, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc<span class="op">-</span>dif, <span class="dt">ymax=</span>z.calc<span class="op">+</span>dif), <span class="dt">width=</span>.<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="kw">print</span>(p)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>    Tpr Ppr z.chart    z.calc           dif
1  1.05 0.5   0.829 0.8243607  4.639281e-03
5  1.05 1.0   0.589 0.6199052 -3.090525e-02
9  1.05 1.5   0.253 0.4692711 -2.162711e-01
13 1.05 2.0   0.280 0.3998218 -1.198218e-01
17 1.05 2.5   0.343 0.3958632 -5.286322e-02
21 1.05 3.0   0.407 0.4292515 -2.225150e-02
25 1.05 3.5   0.471 0.4788553 -7.855318e-03
29 1.05 4.0   0.534 0.5339879  1.210687e-05
33 1.05 4.5   0.598 0.5906236  7.376377e-03
37 1.05 5.0   0.663 0.6475878  1.541217e-02
41 1.05 5.5   0.727 0.7046099  2.239005e-02
45 1.05 6.0   0.786 0.7616403  2.435970e-02
49 1.05 6.5   0.846 0.8186716  2.732842e-02</code></pre>
</div>
<div id="analyzing-performance-of-the-pp-correlation-for-all-the-tpr-curves" class="section level2">
<h2>Analyzing performance of the <code>PP</code> correlation for all the <code>Tpr</code> curves</h2>
<p>In this last example, we compare the values of <code>z</code> at all the isotherms.</p>
<p>We use the function <code>getCurvesDigitized</code> to obtain all the isotherms or <code>Tpr</code> curves in the Standing-Katz chart that have been digitized.</p>
<p>The next function <code>createTidyFromMatrix</code> calculates <code>z</code> using the correlation and prepares a tidy dataset ready to plot.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co"># get all `lp` Tpr curves</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">tpr_all &lt;-<span class="st"> </span><span class="kw">getStandingKatzTpr</span>(<span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) </a>
<a class="sourceLine" id="cb17-7" data-line-number="7">sk_corr_all &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr, tpr_all, <span class="dt">correlation =</span> <span class="st">&quot;PP&quot;</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="kw">as.tibble</span>(sk_corr_all)</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"></a>
<a class="sourceLine" id="cb17-10" data-line-number="10">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_all, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc<span class="op">-</span>dif, <span class="dt">ymax=</span>z.calc<span class="op">+</span>dif), <span class="dt">width=</span>.<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb17-14" data-line-number="14">                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="kw">print</span>(p)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code># A tibble: 112 x 5
   Tpr     Ppr z.chart z.calc       dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
 1 1.05    0.5   0.829  0.824  0.00464 
 2 1.1     0.5   0.854  0.852  0.00229 
 3 1.2     0.5   0.893  0.893  0.000342
 4 1.3     0.5   0.916  0.921 -0.00489 
 5 1.4     0.5   0.936  0.941 -0.00483 
 6 1.5     0.5   0.948  0.955 -0.00721 
 7 1.6     0.5   0.959  0.966 -0.00678 
 8 1.7     0.5   0.968  0.974 -0.00566 
 9 1.8     0.5   0.974  0.980 -0.00563 
10 1.9     0.5   0.978  0.984 -0.00620 
# ... with 102 more rows</code></pre>
</div>
<div id="range-of-applicability-of-the-correlation" class="section level2">
<h2>Range of applicability of the correlation</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># MSE: Mean Squared Error</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co"># RMSE: Root Mean Squared Error</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co"># RSS: residual sum of square</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co"># ARE:  Average Relative Error, %</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co"># AARE: Average Absolute Relative Error, %</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">grouped &lt;-<span class="st"> </span><span class="kw">group_by</span>(sk_corr_all, Tpr, Ppr)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"></a>
<a class="sourceLine" id="cb19-9" data-line-number="9">smry_tpr_ppr &lt;-<span class="st"> </span><span class="kw">summarise</span>(grouped, </a>
<a class="sourceLine" id="cb19-10" data-line-number="10">          <span class="dt">RMSE=</span> <span class="kw">sqrt</span>(<span class="kw">mean</span>((z.chart<span class="op">-</span>z.calc)<span class="op">^</span><span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb19-11" data-line-number="11">          <span class="dt">MPE =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart) <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb19-12" data-line-number="12">          <span class="dt">MAPE =</span> <span class="kw">sum</span>(<span class="kw">abs</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart) <span class="op">/</span><span class="st"> </span>z.chart)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb19-13" data-line-number="13">          <span class="dt">MSE =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart)<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb19-14" data-line-number="14">          <span class="dt">RSS =</span> <span class="kw">sum</span>((z.calc <span class="op">-</span><span class="st"> </span>z.chart)<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb19-15" data-line-number="15">          <span class="dt">MAE =</span> <span class="kw">sum</span>(<span class="kw">abs</span>(z.calc <span class="op">-</span><span class="st"> </span>z.chart)) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb19-16" data-line-number="16">          <span class="dt">RMLSE =</span> <span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">n</span>()<span class="op">*</span><span class="kw">sum</span>((<span class="kw">log</span>(z.calc <span class="op">+</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">log</span>(z.chart <span class="op">+</span><span class="dv">1</span>))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb19-17" data-line-number="17">          )</a>
<a class="sourceLine" id="cb19-18" data-line-number="18"></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="kw">ggplot</span>(smry_tpr_ppr, <span class="kw">aes</span>(Ppr, Tpr)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>smry_tpr_ppr, <span class="kw">aes</span>(<span class="dt">fill=</span>MAPE), <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="st">    </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">mid=</span><span class="st">&quot;yellow&quot;</span>, <span class="dt">na.value =</span> <span class="st">&quot;pink&quot;</span>,</a>
<a class="sourceLine" id="cb19-22" data-line-number="22">                         <span class="dt">midpoint=</span><span class="fl">12.5</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">name=</span><span class="st">&quot;MAPE&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-23" data-line-number="23"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">vjust=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">11</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-24" data-line-number="24"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-25" data-line-number="25"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Papp&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;PP&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="plotting-the-tpr-and-ppr-values-that-show-more-error" class="section level2">
<h2>Plotting the <code>Tpr</code> and <code>Ppr</code> values that show more error</h2>
<p>The <code>MAPE</code> (mean average percentage error) gradient bar indicates that the more red the square is, the more error there is.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">sk_corr_all <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">    </span><span class="kw">filter</span>(Tpr <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1.05&quot;</span>, <span class="st">&quot;1.1&quot;</span>, <span class="st">&quot;1.2&quot;</span>, <span class="st">&quot;2.6&quot;</span>, <span class="st">&quot;2.8&quot;</span>, <span class="st">&quot;3&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z.chart, <span class="dt">y=</span>z.calc, <span class="dt">group =</span> Tpr, <span class="dt">color =</span> Tpr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z.chart, <span class="dt">y =</span> z.chart), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="st">    </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Tpr, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc<span class="op">-</span><span class="kw">abs</span>(dif), <span class="dt">ymax=</span>z.calc<span class="op">+</span><span class="kw">abs</span>(dif)), </a>
<a class="sourceLine" id="cb20-10" data-line-number="10">                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<blockquote>
<p>With the exception of the isotherms at 1.05 and 1.1, the Papp correlation looks acceptable good.</p>
</blockquote>
</div>
<div id="looking-numerically-at-the-errors" class="section level2">
<h2>Looking numerically at the errors</h2>
<p>Finally, the dataframe with the calculated errors between the <code>z</code> from the correlation and the <code>z</code> read from the chart:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">as_tibble</span>(smry_tpr_ppr)</a></code></pre></div>
<pre><code># A tibble: 112 x 9
   Tpr     Ppr    RMSE     MPE   MAPE        MSE        RSS     MAE   RMLSE
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 1.05    0.5 0.00464  -0.560  0.560 0.0000215  0.0000215  0.00464 0.00254
 2 1.05    1.5 0.216    85.5   85.5   0.0468     0.0468     0.216   0.159  
 3 1.05    2.5 0.0529   15.4   15.4   0.00279    0.00279    0.0529  0.0386 
 4 1.05    3.5 0.00786   1.67   1.67  0.0000617  0.0000617  0.00786 0.00533
 5 1.05    4.5 0.00738  -1.23   1.23  0.0000544  0.0000544  0.00738 0.00463
 6 1.05    5.5 0.0224   -3.08   3.08  0.000501   0.000501   0.0224  0.0130 
 7 1.05    6.5 0.0273   -3.23   3.23  0.000747   0.000747   0.0273  0.0149 
 8 1.1     0.5 0.00229  -0.268  0.268 0.00000523 0.00000523 0.00229 0.00123
 9 1.1     1.5 0.110    25.9   25.9   0.0121     0.0121     0.110   0.0744 
10 1.1     2.5 0.0500   12.7   12.7   0.00250    0.00250    0.0500  0.0353 
# ... with 102 more rows</code></pre>
</div>
<div id="references" class="section level2">
<h2>References</h2>
</div>
<div id="references-1" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Hall1973">
<p>Hall, Kenneth R, and Lyman Yarborough. 1973. âA New Equation of State for Z-Factor Calculations.â <em>Oil and Gas Journal</em> 71 (7): 82â92.</p>
</div>
<div id="ref-Papp1979">
<p>Papp, I. 1979. âUj Modszer Foldgazok Elteresi Tenyezojenek Szamitasara.â <em>Koolaj Es Foldgaz</em>, November, 345â47.</p>
</div>
<div id="ref-Takacs1989">
<p>Takacs, Gabor. 1989. âComparing Methods for Calculating Z Factor.â <em>Oil and Gas Journal</em>, May. Oil; Gas Journal. <a href="https://doi.org/Not Available" class="uri">https://doi.org/Not Available</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
